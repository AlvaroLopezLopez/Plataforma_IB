"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7813],{77813:function(e,r,t){t.d(r,{tg:function(){return X},Rt:function(){return eu},Tg:function(){return Y},_d:function(){return rf},MK:function(){return a},Bt:function(){return ts},m8:function(){return eZ},wd:function(){return eV},aH:function(){return eW},w4:function(){return u},QM:function(){return rH},tq:function(){return r3},Wn:function(){return tm},qb:function(){return c},Nj:function(){return ef},fK:function(){return rC},ku:function(){return r1},Ev:function(){return ew},lB:function(){return q},Xj:function(){return rL},cT:function(){return rR}}),(l=a||(a={})).OnBoarding="onboarding",l.Regular="regular";var s,o,n,i,l,a,c,d,u,x,p=t(52322),h=t(2784),m=t(30195),g=t(18149),b=t.n(g),j=t(63955),v=t(88883),f=t(78502),y=t(81836),Z=t(76385),w=t(71946),S=t(60218),I=t(14204),C=t(74143),k=t(19797),E=t(53058),P=t(24502),A=t(57542),T=t(9763),N=t(89621),_=t(94482),F=t(96802),D=t(64116),z=t.n(D),G=t(26275),M=t(78610),L=t(37691),V=t(66258),R=t(25619),O=t(47857),U=t(16962);let H=()=>{let e=(0,f.Z)();return(0,p.jsx)(w.Z,{href:"/",endIcon:(0,p.jsx)(V.Z,{}),sx:{color:e.colors.textIcon.placeholder,ml:10,"&:hover":{bgcolor:"transparent",color:e.colors.button.primary}},children:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",textTransform:"none",children:"Skip"})})},W=()=>{let e=(0,f.Z)(),{contactUsUrl:r}=(0,E.JR)();return(0,p.jsx)(w.Z,{LinkComponent:G.Z,href:r,sx:{color:e.colors.textIcon.placeholder,"&:hover":{bgcolor:"transparent",color:e.colors.button.primary}},children:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",textTransform:"none",children:"Can't choose your subjects? Contact Support"})})},B=e=>{let{subjectGroups:r,email:t,onSucc:s,flowType:o,initialSubjectGroups:n,subjectGroupSubscriptionAccess:i={}}=e,l=(0,f.Z)(),{api:c}=(0,R.Qy)(),{curriculumName:d}=(0,E.JR)(),{contentHierarchy:u}=(0,O.kt)(),[x,m]=(0,h.useState)(null!=n?n:[]),[g,b]=(0,h.useState)(!1),j=r.map(e=>{let r=(0,U._A)(e.name);return{label:"".concat("IGCSE"===d?e.superGroupName:d," ").concat(e.name),icon:r&&(0,p.jsx)(r,{}),id:e.id,isPro:!!i[e.id]}}),v=async()=>{try{var e;b(!0);let r=u.curricula.flatMap(e=>e.subjectSuperGroups).flatMap(e=>e.subjectGroups).map(e=>e.id),t=null!==(e=null==n?void 0:n.filter(e=>!r.includes(e)))&&void 0!==e?e:[],{data:o}=await c.users.updateUser("me",{subjectGroups:[...t,...x]});b(!1),P.A9.success("Subject groups updated successfully!"),null==s||s(o)}catch(e){b(!1),F.kg.error("Failed to update subject groups",{error:e}),P.A9.error("Something went wrong. Please try again later")}};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Z.Z,{variant:"h5-bold",color:l.colors.textIcon.primary,children:"Subjects"}),(0,p.jsxs)(y.Z,{gap:2,children:[(0,p.jsx)(Z.Z,{variant:"p-md-semibold",color:l.colors.textIcon.primary,children:"Which subject(s) do you teach?"}),(0,p.jsx)(y.Z,{width:{lg:"560px",xs:"100%"},sx:{minWidth:"344px"},flexDirection:"row",flexWrap:"wrap",children:(0,p.jsx)(M.Z,{sx:{width:"100%",display:"flex",flexDirection:"row",gap:2,color:l.colors.textIcon.primary,label:{width:{xs:"164px",md:"176px"},display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"flex-start",p:2,margin:0,borderRadius:2,backgroundColor:l.colors.ui.bg_panel},"label:hover":{borderColor:l.colors.button.primary}},children:j.map(e=>{var r;let t=x.includes(e.id)||e.isPro;return(0,p.jsx)(L.Z,{label:(0,p.jsxs)(y.Z,{spacing:1,children:[(0,h.cloneElement)(null!==(r=e.icon)&&void 0!==r?r:(0,p.jsx)(_.F8,{}),{sx:{width:"32px",height:"32px"}}),(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",children:e.label})]}),labelPlacement:"start",control:(0,p.jsx)(I.Z,{value:e.id,disabled:e.isPro,size:"small",icon:(0,p.jsx)(_.IE,{}),checkedIcon:(0,p.jsx)(_.Fw,{}),onChange:(r,t)=>{m(r=>{let s=[...r];return t?s.push(e.id):z()(s,r=>r===e.id),s})},sx:{mt:-2,mr:-2,svg:{fontSize:"1rem"},":hover":{bgcolor:"transparent"}},checked:t}),sx:{border:"1px solid",borderColor:t?l.colors.button.primary:"transparent"}},e.label)})})})]}),(0,p.jsxs)(y.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,p.jsxs)(y.Z,{gap:1,children:[(0,p.jsx)(w.Z,{variant:"solid",color:"primary",disabled:g,sx:{"&&":{width:"100%",maxWidth:{xs:"100%",lg:"272px"},justifyContent:"center"}},"data-analytics-on":"click","data-analytics-name":"clickUpdateProfileSubmit","data-analytics-attrs":"email:".concat(t),onClick:v,children:(0,p.jsx)(A.aN,{isLoading:g,size:20,sx:{color:l.colors.textIcon.inverse},children:(0,p.jsx)(Z.Z,{variant:"p-lg-semibold",children:"Update"})})}),(0,p.jsx)(W,{})]}),o===a.OnBoarding&&(0,p.jsx)(H,{})]})]})},Y=e=>{let{selectedCohort:r,cohortLabel:t,control:s}=e,o=(0,f.Z)();return(0,p.jsx)(L.Z,{sx:{marginLeft:0,"& .MuiCheckbox-root":{p:0,mr:1},"&":{p:2,width:"100%",backgroundColor:o.colors.ui.bg_panel,borderRadius:2,border:"1px solid ".concat(o.colors.ui.bg_panel),borderColor:r===t?o.colors.textIcon.primary:o.colors.ui.bg_panel},"&:hover":{borderColor:o.colors.textIcon.primary}},label:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:o.colors.textIcon.primary,children:t}),control:s})},Q=F.kg.child({from:"AcademicInfoForm"}),K={school:"My school is not listed",ibCode:null,country:null,region:null},q=(e,r,t)=>r!==K.school||e?e&&t.find(r=>r.ibCode===e)||null:K,J=m.z.object({finalExamPeriods:m.z.string().nullable(),school:m.z.object({school:m.z.string(),ibCode:m.z.string().nullish(),country:m.z.string().nullish(),region:m.z.string().nullish()}).nullable()}).refine(e=>null!==e.school,{message:"Please select your school",path:["school"]}),X=e=>{var r;let{initialValues:t,onSubmit:s,email:o,flowType:n,schoolsData:i,cohorts:l}=e,c=(0,f.Z)(),[d,u]=(0,h.useState)(!1),x=(0,j.cI)({resolver:(0,v.F)(J),defaultValues:t}),m=null!==(r=t.kind)&&void 0!==r?r:T.VF.Student;return(0,p.jsx)(j.RV,{...x,children:(0,p.jsx)("form",{onSubmit:x.handleSubmit(e=>{u(!0),s(e).then(()=>{P.A9.success("Profile saved successfully")}).catch(e=>{P.A9.success("Error occurred while saving your profile. Please try again later."),Q.error("Failed to update academic info",{error:e})}).finally(()=>{u(!1)})}),children:(0,p.jsxs)(y.Z,{spacing:{xs:3,lg:5},children:[(0,p.jsx)(Z.Z,{variant:"h5-bold",color:c.colors.textIcon.primary,children:"Academic info"}),(0,p.jsx)($,{kind:m,schoolsData:i,cohorts:l}),(0,p.jsxs)(y.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,p.jsx)(w.Z,{variant:"solid",size:"large",type:"submit",disabled:d,sx:{width:"100%",maxWidth:{xs:"100%",lg:"272px"}},"data-analytics-on":"click","data-analytics-name":"clickUpdateProfileSubmit","data-analytics-attrs":"email:".concat(o),children:(0,p.jsx)(A.aN,{isLoading:d,size:24,sx:{margin:"auto",mt:.5,color:c.colors.textIcon.inverse},children:"Save"})}),n===a.OnBoarding&&(0,p.jsx)(H,{})]})]})})})},$=e=>{let{kind:r,schoolsData:t,cohorts:s}=e,o=(0,f.Z)(),{curriculumName:n}=(0,E.JR)(),i=(0,j.Gc)();return(0,p.jsxs)(y.Z,{spacing:4,children:["teacher"!==r&&(0,p.jsxs)(y.Z,{gap:2,children:[(0,p.jsxs)(Z.Z,{variant:"p-md-semibold",color:o.colors.textIcon.primary,children:["When will you sit your final ",n," examinations?"]}),(0,p.jsx)(j.Qr,{name:"finalExamPeriods",render:e=>{let{field:r}=e;return(0,p.jsx)(S.ZP,{container:!0,spacing:2,children:s.map(e=>(0,p.jsx)(S.ZP,{item:!0,xs:6,children:(0,p.jsx)(Y,{cohortLabel:e,selectedCohort:r.value,control:(0,p.jsx)(I.Z,{size:"small",icon:(0,p.jsx)(_.uF,{}),checkedIcon:(0,p.jsx)(_.b2,{}),sx:{svg:{fontSize:"1rem"}},value:e,checked:r.value===e,onChange:(e,t)=>{t?r.onChange(e.target.value):r.onChange(null)}})})},e))})}})]}),(0,p.jsx)(N.Ab,{name:"school",label:"Your ".concat(n," School"),options:t,groupBy:e=>e.country,getOptionLabel:e=>"string"==typeof e?e:e.school,size:"small",textfieldProps:{InputProps:{startAdornment:(0,p.jsx)(C.Z,{position:"start",children:(0,p.jsx)(_._V,{})}),sx:{color:o.colors.textIcon.primary}},placeholder:"Start typing your school or country"},filterOptions:(0,k.D)({stringify:e=>"".concat(e.country," ").concat(e.school)}),noOptionsText:(0,p.jsxs)(y.Z,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:o.colors.textIcon.primary,children:"Your school is not listed?"}),(0,p.jsx)(w.Z,{type:"button",sx:{borderRadius:4,bgcolor:o.colors.common.brand[50],color:o.colors.textIcon.placeholder,textTransform:"none",":hover":{color:o.colors.textIcon.primary,bgcolor:o.colors.common.brand[50]}},onClick:()=>i.setValue("school",K),children:(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",children:"Yes"})})]}),isOptionEqualToValue:b()})]})};var ee=t(5632),er=t(59888),et=t(52519),es=t(15794),eo=t(1676),en=t(65235),ei=t(34175),el=t(73226),ea=t(11096),ec=t(81763),ed=t(66357);let eu=e=>{let{page:r,children:t,userFreeTrialStatWithCode:s,kind:o=T.VF.Student}=e,n=(0,f.Z)(),i=(0,ee.useRouter)(),l=(0,h.useMemo)(()=>{let e=[{icon:(0,p.jsx)(_.w4,{}),label:"Profile Settings",href:"/account-settings/profile-settings",disabled:!1},{icon:(0,p.jsx)(_.EA,{}),label:"Membership",href:"/account-settings/membership",disabled:!1},{icon:(0,p.jsx)(_.Nj,{}),label:"Billing",href:"/account-settings/billing",disabled:!1}];return o===T.VF.Teacher&&e.push({icon:(0,p.jsx)(_.Gt,{}),label:"Manage Users",href:"/my-account/manage-users/",disabled:!1,endIcon:(0,p.jsx)(ec.Z,{})}),e},[o]),a=e=>{var r;let t=null===(r=l.find(r=>r.label===e))||void 0===r?void 0:r.href;t&&i.push(t)};return(0,p.jsx)(ed.V,{userFreeTrialStatWithCode:s,children:(0,p.jsx)(er.Z,{bgcolor:n.colors.ui.bg_light,sx:{minHeight:"calc(100vh - 414px)",display:"flex",flexDirection:"column",overflow:"hidden"},children:(0,p.jsxs)(et.Z,{maxWidth:"xl",sx:{flexGrow:1,display:"flex",flexDirection:{xs:"column",lg:"row"},height:"100%"},children:[(0,p.jsxs)(y.Z,{flexBasis:{lg:"34%"},alignItems:{xs:"center",lg:"flex-start"},position:"relative",children:[(0,p.jsx)(er.Z,{sx:{position:"absolute",right:{xs:"-10vw",lg:0},top:0,height:"100%",width:{xs:"110vw",lg:"50vw"},bgcolor:n.colors.common.brand[100]}}),(0,p.jsxs)(y.Z,{zIndex:2,sx:{py:{lg:12,xs:7.5},width:"100%",pb:{xs:3.75},alignItems:{xs:"center",lg:"flex-start"}},gap:6,children:[(0,p.jsx)(Z.Z,{variant:"h2-bold",color:n.colors.textIcon.primary,children:"Account Settings"}),(0,p.jsx)(es.Z,{value:r,IconComponent:ea.Z,sx:{display:{xs:"block",lg:"none"},maxWidth:"450px",background:n.colors.common.brand[50],border:"none",borderRadius:8,height:"48px",width:"100%","& fieldset":{border:"none"},"&>svg":{right:"16px",color:n.colors.button.primary},"&&& .MuiSelect-select":{px:2,py:0,display:"flex",flexDirection:"row",alignItems:"center",height:"48px"},".MuiListItemText-root":{ml:-2}},MenuProps:{MenuListProps:{sx:{py:0}},PaperProps:{sx:{boxShadow:"none",background:n.colors.common.brand[50],borderRadius:4}}},children:l.map(e=>{let t=e.label===r;return(0,p.jsxs)(eo.Z,{value:e.label,selected:t,disabled:e.disabled,sx:{mb:2.5,px:2.5,borderRadius:"32px",color:n.colors.textIcon.placeholder,height:"48px","&:hover":{color:n.colors.textIcon.primary,backgroundColor:"transparent"},"&&.Mui-selected":{backgroundColor:n.colors.subjectGroup.math[50],color:n.colors.textIcon.primary}},onClick:()=>{a(e.label)},children:[(0,p.jsx)(en.Z,{children:(0,h.cloneElement)(e.icon,{fill:t?n.colors.textIcon.primary:void 0})}),(0,p.jsx)(ei.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-md-semibold",children:e.label})})]},e.label)})}),(0,p.jsx)(el.Z,{sx:{width:"240px",display:{xs:"none",lg:"block"}},children:l.map(e=>{let t=e.label===r;return(0,p.jsxs)(eo.Z,{selected:t,disabled:e.disabled,sx:{mb:2.5,px:2.5,borderRadius:"32px",color:n.colors.textIcon.placeholder,height:"48px","&:hover":{color:n.colors.textIcon.primary,backgroundColor:"transparent"},"&&.Mui-selected":{backgroundColor:n.colors.subjectGroup.math[50],color:n.colors.textIcon.primary,opacity:1}},onClick:()=>{a(e.label)},children:[(0,p.jsx)(en.Z,{children:(0,h.cloneElement)(e.icon,{fill:t?n.colors.textIcon.primary:void 0})}),(0,p.jsx)(ei.Z,{children:(0,p.jsxs)(y.Z,{flexDirection:"row",width:"100%",justifyContent:"space-between",children:[(0,p.jsx)(Z.Z,{variant:"p-md-semibold",children:e.label}),e.endIcon&&e.endIcon]})})]},e.label)})})]})]}),(0,p.jsx)(y.Z,{flexBasis:{lg:"66%"},children:t})]})})})};var ex=t(28879),ep=t.n(ex),eh=t(33835),em=t(13291),eg=t(48155),eb=t(12632),ej=t(11088),ev=t(71025);(s=c||(c={})).Active="Active",s.Expired="Expired";let ef=e=>{let{status:r}=e,t=(0,f.Z)(),s={Active:t.colors.common.success[400],Expired:t.colors.common.brick[400],[ev.iF.Confirmed]:t.colors.common.purple[400],[ev.iF.Created]:t.colors.common.success[400],[ev.iF.Cancelled]:t.colors.common.brick[400],[ev.yh.Incomplete]:t.colors.common.brick[400],[ev.yh.IncompleteExpired]:t.colors.common.brick[400],[ev.yh.PastDue]:t.colors.common.brick[400],[ev.yh.Paused]:t.colors.common.brick[400],[ev.yh.Trialing]:t.colors.common.brick[400],[ev.yh.Unpaid]:t.colors.common.brick[400]};return(0,p.jsx)(Z.Z,{variant:"p-xs-semibold",color:t.colors.textIcon.inverse,textTransform:"capitalize",sx:{display:"inline-block",borderRadius:"4px",bgcolor:s[r],py:.25,px:6/8},children:r})},ey=e=>{let{text:r}=e,t=(0,f.Z)();return(0,p.jsxs)(y.Z,{flexDirection:"row",p:2,height:"68px",borderRadius:"16px",alignItems:"center",border:"1px solid ".concat(t.colors.ui.border_dark),sx:{"&&":{mt:4}},children:[(0,p.jsx)(_.sz,{}),(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:t.colors.textIcon.placeholder,ml:1,children:r})]})},eZ=e=>{let{orders:r}=e,t=(0,f.Z)(),s=r.flatMap(e=>e.orderItems.map(r=>({...r,orderDate:e.orderDate,currency:e.currency,status:e.status})));return s.length?(0,p.jsxs)(eh.Z,{sx:{th:{color:t.colors.textIcon.info,px:0,py:1.5,verticalAlign:"top"},td:{px:0,color:t.colors.textIcon.primary,verticalAlign:"top"}},children:[(0,p.jsx)(em.Z,{children:(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{width:"18%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Order Date"})}),(0,p.jsx)(eb.Z,{width:"52%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Product"})}),(0,p.jsx)(eb.Z,{width:"15%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Price"})}),(0,p.jsx)(eb.Z,{width:"15%",sx:{textAlign:"right"},children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Status"})})]})}),(0,p.jsx)(ej.Z,{children:s.map(e=>{var r;return(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",children:ep()(e.orderDate).format("YYYY-MM-DD")})}),(0,p.jsx)(eb.Z,{children:(0,p.jsxs)(y.Z,{sx:{color:t.colors.textIcon.primary},gap:"5px",children:[(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",children:e.names.productName}),e.names.productVariantDesc&&(0,p.jsx)(Z.Z,{variant:"p-xs-semibold",color:(null===(r=e.notes)||void 0===r?void 0:r.isFreeTrial)?t.colors.button.cta_blue:t.colors.common.gold[700],children:e.names.productVariantDesc})]})}),(0,p.jsx)(eb.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",children:0===e.price?"Free":"".concat(e.price/100," ").concat(e.currency)})}),(0,p.jsx)(eb.Z,{sx:{textAlign:"right"},children:e.status===ev.iF.Cancelled?"Refunded":(0,p.jsx)(ef,{status:e.status})})]},e.id)})})]}):(0,p.jsx)(ey,{text:"You havenâ€™t placed any orders yet."})},ew=e=>{let{subscriptions:r}=e,t=(0,f.Z)(),s=r.flatMap(e=>{var r;return null===(r=e.subscriptionItems)||void 0===r?void 0:r.map(r=>({...r,periodStartsAt:e.periodStartsAt,periodEndsAt:e.periodEndsAt,status:e.status}))});return s.length?(0,p.jsxs)(eh.Z,{sx:{th:{color:t.colors.textIcon.info,px:0,py:1.5,verticalAlign:"top"},td:{px:0,color:t.colors.textIcon.primary,verticalAlign:"top"}},children:[(0,p.jsx)(em.Z,{children:(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{width:"18%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Start Date"})}),(0,p.jsx)(eb.Z,{width:"35%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Product"})}),(0,p.jsx)(eb.Z,{width:"20%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Price"})}),(0,p.jsx)(eb.Z,{width:"15%",children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Renewal Date"})}),(0,p.jsx)(eb.Z,{width:"12%",sx:{textAlign:"right"},children:(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Status"})})]})}),(0,p.jsx)(ej.Z,{children:s.map(e=>e?(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",children:ep()(null==e?void 0:e.periodStartsAt).format("YYYY-MM-DD")})}),(0,p.jsx)(eb.Z,{children:(0,p.jsxs)(y.Z,{sx:{color:t.colors.textIcon.primary},gap:"5px",children:[(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",children:e.names.productName}),(e.names.productVariantDesc||e.names.productVariantNote)&&(0,p.jsxs)(y.Z,{color:e.status===ev.yh.Active?t.colors.common.gold[700]:t.colors.common.purple[600],children:[!!e.names.productVariantDesc&&(0,p.jsx)(Z.Z,{variant:"p-xs-semibold",children:e.names.productVariantDesc}),!!e.names.productVariantNote&&(0,p.jsxs)(Z.Z,{variant:"p-xs-rg",children:["(",e.names.productVariantNote,")"]})]})]})}),(0,p.jsx)(eb.Z,{children:(0,p.jsxs)(Z.Z,{variant:"p-sm-rg",children:[" ",null==e?void 0:e.price]})}),(0,p.jsx)(eb.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-sm-rg",children:ep()(null==e?void 0:e.periodEndsAt).format("YYYY-MM-DD")})}),(0,p.jsx)(eb.Z,{sx:{textAlign:"right"},children:(null==e?void 0:e.status)&&(0,p.jsx)(ef,{status:e.status})})]},null==e?void 0:e.id):null)})]}):(0,p.jsx)(ey,{text:"You have no active subscriptions at the moment."})};var eS=t(16619),eI=t(6640),eC=t(14313),ek=t(67614),eE=t(28573),eP=t(81014),eA=t(51379),eT=t(84311);let eN=m.z.object({oldPassword:m.z.string().min(8,"must be at least 8 characters"),newPassword:m.z.string().min(8,"must be at least 8 characters"),confirmNewPassword:m.z.string()}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"Passwords don't match",path:["confirmNewPassword"]}),e_=e=>{let r=(0,f.Z)(),{updatePassword:t}=(0,eE.aC)(),[s,o]=(0,h.useState)(!1),{open:n,setIsOpen:i}=e,l=(0,j.cI)({resolver:(0,v.F)(eN),defaultValues:{oldPassword:"",newPassword:"",confirmNewPassword:""}});return(0,p.jsx)(eC.Z,{theme:eP.rS,children:(0,p.jsx)(A.u_,{disableMobileDrawer:!0,open:n,scrollable:!0,containerStyle:{borderRadius:4},analyticsName:"resetPasswordModal",onClose:()=>{i(!1)},children:(0,p.jsx)(et.Z,{sx:{"&&":{overflow:"hidden",width:{md:(0,eA.Q1)(656),xs:"auto"},p:(0,eA.Q1)(48)}},children:(0,p.jsxs)(y.Z,{alignSelf:"stretch",children:[(0,p.jsxs)(y.Z,{pb:(0,eA.Q1)(24),children:[(0,p.jsx)(Z.Z,{variant:"h3",color:r.colors.textIcon.primary,mb:(0,eA.Q1)(12),children:"Reset Password"}),(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:"Please fill out the form below to update your password."})]}),(0,p.jsx)(y.Z,{flexDirection:"column",pt:(0,eA.Q1)(24),children:(0,p.jsx)(j.RV,{...l,children:(0,p.jsxs)("form",{onSubmit:l.handleSubmit(e=>{o(!0),t({newPassword:e.newPassword,oldPassword:e.oldPassword}).then(()=>{P.A9.success("Successfully updated password"),i(!1)}).catch(()=>{P.A9.error("Something went wrong. Please try again.")}).finally(()=>{o(!1)})}),children:[(0,p.jsxs)(y.Z,{spacing:2.5,pb:(0,eA.Q1)(24),gap:1,children:[(0,p.jsx)(N.PV,{name:"oldPassword",label:"Old Password",type:"password",placeholder:"Enter your old password",readOnly:s,variant:"standard"}),(0,p.jsx)(N.PV,{name:"newPassword",label:"New Password",type:"password",placeholder:"Enter you new password",readOnly:s,variant:"standard"}),(0,p.jsx)(N.PV,{name:"confirmNewPassword",label:"Confirm password",type:"password",placeholder:"Enter your password again",readOnly:s,variant:"standard"})]}),(0,p.jsx)(y.Z,{flexDirection:"column",alignSelf:"stretch",pt:(0,eA.Q1)(24),children:(0,p.jsx)(w.Z,{variant:"primary-md",type:"submit",disabled:s,sx:{"&&":{backgroundColor:r.colors.ui.cta,width:"100%"}},children:(0,p.jsx)(A.aN,{isLoading:s,size:20,sx:{margin:"auto",mt:.5,color:r.palette.common.white},children:"Submit"})})})]})})})]})})})})},eF=e=>{let r=(0,f.Z)(),{open:t,setIsOpen:s,selectedMfaPreference:o,handleMfaConfirmation:n}=e,i=o===eE.Wi.Email?"Email":"App";return(0,p.jsx)(eC.Z,{theme:eP.rS,children:(0,p.jsx)(A.u_,{disableMobileDrawer:!0,open:t,scrollable:!0,containerStyle:{borderRadius:4},analyticsName:"mfaConfirmationModal",onClose:()=>{s(!1)},children:(0,p.jsx)(et.Z,{sx:{"&&":{overflow:"hidden",width:{md:(0,eA.Q1)(560),xs:"auto"},p:(0,eA.Q1)(48)}},children:(0,p.jsxs)(y.Z,{alignSelf:"stretch",children:[(0,p.jsxs)(y.Z,{pb:(0,eA.Q1)(24),children:[(0,p.jsxs)(Z.Z,{variant:"h3",color:r.colors.textIcon.primary,mb:(0,eA.Q1)(24),children:["Turn on 2FA via ",i]}),(0,p.jsxs)(Z.Z,{variant:"p-md-rg",color:r.colors.textIcon.primary,children:["Are you sure you want to enable ",i," two-factor authentication? This will require you to receive a code via email every time you log in."]})]}),(0,p.jsxs)(y.Z,{display:"flex",justifyContent:"center",flexDirection:{xs:"column",md:"row"},gap:(0,eA.Q1)(16),alignSelf:{xs:"center",md:"flex-start"},children:[(0,p.jsx)(w.Z,{onClick:()=>{s(!1)},sx:{width:{xs:"auto",md:(0,eA.Q1)(168)}},variant:"solid",color:"secondary",children:"Cancel"}),(0,p.jsx)(w.Z,{onClick:()=>n(o),sx:{width:{xs:"auto",md:(0,eA.Q1)(280)}},variant:"solid",color:"cta",children:"Confirm and Turn on"})]})]})})})})},eD=e=>{let{selectedMfaMethod:r,defaultMfaPreference:t,onClickActions:s,isMfaRequired:o,isMfaEnabled:n}=e;return o?{label:"Turn on 2FA",disabled:r===t,onClick:s.turnOn2FA}:n&&r===t?{label:"Turn off 2FA",disabled:!1,onClick:s.turnOff2FA}:{label:"Turn on 2FA",disabled:r===eE.Wi.None,onClick:s.turnOn2FA}},ez=F.kg.child({from:"PasswordAndSecurityForm"}),eG=[{id:"email",label:"Send code via email",value:"email"},{id:"totp",label:"Authenticator app",value:"totp"}],eM=e=>{let{email:r}=e,t=(0,f.Z)(),[s,o]=(0,h.useState)(!1);return(0,p.jsxs)(y.Z,{children:[(0,p.jsx)(er.Z,{children:(0,p.jsx)(Z.Z,{variant:"h5-bold",color:t.colors.ui.primary,children:"Reset password"})}),(0,p.jsx)(er.Z,{mt:1,children:(0,p.jsx)(Z.Z,{variant:"p-md-rg",color:t.colors.textIcon.placeholder,children:"To reset your password, click the button below and follow the instructions."})}),(0,p.jsx)(er.Z,{mt:2,children:(0,p.jsx)(w.Z,{variant:"solid",color:"cta",type:"submit",onClick:()=>{o(!0)},sx:{"&&":{width:"100%",maxWidth:{xs:"100%",lg:"272px"}}},"data-analytics-on":"click","data-analytics-name":"clickPasswordReset","data-analytics-attrs":"email:".concat(r),children:"Reset Password"})}),s&&(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(e_,{open:s,setIsOpen:o})})]})},eL=()=>{var e,r;let t=(0,f.Z)(),{getSoftwareMfaChallengeDetails:s,enableEmailMfa:o,disableMfa:n}=(0,eE.Sv)(),{user:i,isLoading:l}=(0,ek.v$)(),{knowledgebaseUrl:a}=(0,E.JR)(),[c,d]=(0,h.useState)({qrCodeLink:"",sharedSecret:""}),[u,x]=(0,h.useState)(!1),[m,g]=(0,h.useState)(!1),[b,j]=(0,h.useState)(i),[v,S]=(0,h.useState)((null==i?void 0:i.mfaMethodPreference)||eE.Wi.None),[I,C]=(0,h.useState)(!1),k=null!==(e=null==b?void 0:b.mfa_required)&&void 0!==e&&e,T=null!==(r=null==b?void 0:b.mfa_enabled)&&void 0!==r&&r,{label:N,disabled:_,onClick:F}=eD({selectedMfaMethod:v,defaultMfaPreference:(null==i?void 0:i.mfaMethodPreference)||eE.Wi.None,onClickActions:{turnOn2FA:()=>{C(!0)},turnOff2FA:()=>{G()}},isMfaRequired:k,isMfaEnabled:T}),D=e=>{j(r=>({...r,...e}))},z=async()=>{g(!0);try{let e=await s();d(e),x(!0)}catch(e){P.A9.error("Something went wrong. Please try again."),ez.error("Failed to get 2FA challenge details",{error:e})}g(!1)},G=async()=>{let e=v===eE.Wi.Email?"Email":"App";try{let r=await n();P.A9.success("".concat(e," 2FA has been turned off.")),D({...r,mfaMethodPreference:eE.Wi.None})}catch(r){P.A9.error("Something went wrong disabling ".concat(e,". Please try again.")),ez.error("Failed to disable 2FA",{error:r})}S(eE.Wi.None)},M=async e=>{C(!1),e===eE.Wi.Email?(D({...await o(),mfaMethodPreference:eE.Wi.Email}),P.A9.success("Email 2FA has been turned on.")):e===eE.Wi.TOTP&&z()},V=(0,p.jsxs)(y.Z,{gap:(0,eA.Q1)(24),children:[(0,p.jsx)(y.Z,{children:(0,p.jsx)(eS.Z,{row:!0,value:v,onChange:e=>S(e.target.value),sx:{gap:1},children:eG.map(e=>(0,p.jsx)(er.Z,{height:(0,eA.Q1)(52),display:"flex",sx:{backgroundColor:"#E8E8E8",borderRadius:(0,eA.Q1)(8),border:"1px solid #E8E8E8"},p:(0,eA.Q1)(16),children:(0,p.jsx)(L.Z,{control:(0,p.jsx)(eI.Z,{sx:{"& .MuiSvgIcon-root":{fontSize:(0,eA.Q1)(16),color:t.colors.textIcon.primary}}}),label:e.label,value:e.id,sx:{justifyContent:"space-between",color:t.colors.textIcon.primary,"&. MuiTypography-root":{fontSize:(0,eA.Q1)(14)}}},e.id)},e.id))},"mfaMethodOptions")}),(0,p.jsx)(y.Z,{spacing:t.spacing(1),children:(0,p.jsx)(w.Z,{variant:"solid",color:"cta",type:"submit",disabled:_,onClick:F,sx:{"&&":{maxWidth:{xs:"100%",lg:(0,eA.Q1)(272)}}},children:(0,p.jsx)(A.aN,{isLoading:m,size:20,sx:{margin:"auto",mt:.5,color:t.colors.ui.bg_panel},children:N})})})]}),R=(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(A.aN,{isLoading:!0,size:50,sx:{margin:"auto",mt:.5}})});return(0,p.jsxs)(y.Z,{gap:(0,eA.Q1)(24),children:[(0,p.jsxs)(y.Z,{children:[(0,p.jsx)(er.Z,{children:(0,p.jsx)(Z.Z,{variant:"h5-bold",color:t.colors.ui.primary,children:"Turn on two factor authentication"})}),(0,p.jsx)(er.Z,{mt:1,children:(0,p.jsxs)(Z.Z,{variant:"p-md-rg",color:t.colors.textIcon.placeholder,children:["Please enable two factor authentication in your account with one of two options: either receive a code via email or use an authenticator app to generate a code."," ",(0,p.jsx)("a",{href:"".concat(a,"/setting-up-two-factor-authentication"),target:"_blank",rel:"noreferrer",children:"How it works"})]})})]}),l?R:V,(0,p.jsx)(eT.b7,{totpDetails:c,open:u,setIsOpen:x}),(0,p.jsx)(eF,{handleMfaConfirmation:M,selectedMfaPreference:v,open:I,setIsOpen:C})]})},eV=e=>{let{email:r}=e;return(0,p.jsx)(eC.Z,{theme:eP.rS,children:(0,p.jsxs)(y.Z,{gap:(0,eA.Q1)(48),children:[(0,p.jsx)(er.Z,{children:(0,p.jsx)(eM,{email:r})}),(0,p.jsx)(er.Z,{children:(0,p.jsx)(eL,{})})]})})};var eR=t(55288);let eO=e=>{let{firstName:r,lastName:t,kind:s}=e,o=(0,f.Z)();return(0,p.jsxs)(y.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,p.jsxs)(eR.Z,{sx:{width:80,height:80,fontSize:"32px",fontWeight:700,backgroundColor:o.colors.textIcon.primary,color:o.palette.common.white},children:[r[0]||"?",t[0]||"?"]}),(0,p.jsxs)(y.Z,{children:[(0,p.jsx)(Z.Z,{variant:"p-md-semibold",color:o.colors.textIcon.primary,children:"".concat(r," ").concat(t)}),s&&(0,p.jsx)(Z.Z,{variant:"p-sm-rg",textTransform:"capitalize",color:o.colors.textIcon.placeholder,children:s})]})]})},eU=F.kg.child({from:"PersonalInfoForm"}),eH=m.z.object({firstName:m.z.string().min(1,"First name must not be empty"),lastName:m.z.string().min(1,"Last name must not be empty")}),eW=e=>{let{initialValues:r,onSubmit:t}=e,{user:s}=(0,ek.v$)(),o=(0,f.Z)(),[n,i]=(0,h.useState)(!1),l=(0,j.cI)({resolver:(0,v.F)(eH),defaultValues:r}),{email:a,kind:c,firstName:d,lastName:u}=r;return(0,p.jsx)(j.RV,{...l,children:(0,p.jsx)("form",{onSubmit:l.handleSubmit(e=>{i(!0),t(e).then(()=>{P.A9.success("Profile saved successfully")}).catch(e=>{P.A9.success("Error occurred while saving your profile. Please try again later."),eU.error("Failed to update personal info",{error:e})}).finally(()=>{i(!1)})}),children:(0,p.jsxs)(y.Z,{spacing:{xs:3,lg:5},children:[(0,p.jsx)(eO,{firstName:d,lastName:u,kind:c}),(0,p.jsxs)(y.Z,{spacing:3,children:[(0,p.jsxs)(y.Z,{direction:"row",spacing:2,children:[(0,p.jsx)(N.PV,{name:"firstName",label:"First Name *",placeholder:"First name",variant:"inverse"}),(0,p.jsx)(N.PV,{name:"lastName",label:"Last Name *",placeholder:"Last name",variant:"inverse"})]}),(0,p.jsx)(N.y5,{name:"email",label:"Email",disabled:!0,readOnly:!0,value:a,variant:"inverse"})]}),(0,p.jsx)(w.Z,{variant:"solid",size:"large",type:"submit",disabled:n,sx:{width:"100%",maxWidth:{xs:"100%",lg:"272px"}},"data-analytics-on":"click","data-analytics-name":"clickUpdateProfileSubmit","data-analytics-attrs":"email:".concat(null==s?void 0:s.email),children:(0,p.jsx)(A.aN,{isLoading:n,size:24,sx:{margin:"auto",mt:.5,color:o.colors.ui.bg_panel},children:"Save"})})]})})})};var eB=t(82066),eY=t(84636),eQ=t.n(eY),eK=t(36234),eq=t(39097),eJ=t.n(eq),eX=t(1804),e$=t(20614),e0=t(44258),e1=t(17625),e2=t(958),e5=t(28783),e4=t(7257),e6=t(25200),e8=t(23951),e3=t(6426),e7=t(34758),e9=t(12261),re=t(43653),rr=t(47137),rt=t(15883);(o=d||(d={})).Default="default",o.Product="product",o.Subscription="subscription";let rs=e=>{let{children:r,upperCase:t=!1,type:s="default"}=e,o="default"===s?rt.O.blue:"product"===s?rt.O.green:rt.O.pink;return(0,p.jsx)(A.Vp,{sx:{border:"none",background:o.light,display:"inline-block",padding:"6px 14px"},typographyProps:{color:o.dark,fontSize:"0.7rem",lineHeight:1.5,textTransform:t?"uppercase":"none"},children:r})},ro=e=>{let{open:r,onClose:t,dealCohortName:s,allowedEntities:o,maxEntities:n,totalSeatsAvailable:i,assignedSeats:l,type:a,assignUsers:c,isLoading:d}=e,u=m.z.object({users:m.z.object({email:m.z.string().email(),userKind:m.z.nativeEnum(T.VF),allocatedEntities:m.z.string().array().max(n)}).array().max(i-l)}),x=(0,f.Z)(),{control:h,handleSubmit:g,formState:b}=(0,j.cI)({defaultValues:{users:[{email:"",userKind:T.VF.Student,allocatedEntities:[]}]},resolver:(0,v.F)(u)}),{fields:S,append:I,remove:C}=(0,j.Dq)({control:h,name:"users"});return(0,p.jsx)(A.u_,{analyticsName:"add-users-through-key-contact",open:r,onClose:t,children:(0,p.jsxs)(e7.Z,{sx:{p:4,maxHeight:"80vh",overflowY:"auto",background:x.palette.background.default,width:{xs:"100vw",mg:"80vw"},maxWidth:x.spacing(150)},children:[(0,p.jsxs)(Z.Z,{variant:"h5-semibold",sx:{textAlign:"left"},children:["Add Users To ",s]}),(0,p.jsx)("form",{onSubmit:g(e=>c(e.users)),children:(0,p.jsxs)(y.Z,{spacing:2,children:[(0,p.jsx)(e2.Z,{sx:{td:{paddingY:0,paddingX:x.spacing(.5),border:"none"}},children:(0,p.jsxs)(eh.Z,{children:[(0,p.jsx)(em.Z,{children:(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{colSpan:2,children:"Email"}),(0,p.jsx)(eb.Z,{children:"User Kind"}),(0,p.jsxs)(eb.Z,{colSpan:2,children:["Course(s): choose up to ",n]})]})}),(0,p.jsx)(ej.Z,{children:S.map((e,r)=>(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{colSpan:2,sx:{verticalAlign:"top",width:"40%"},children:(0,p.jsx)(j.Qr,{name:"users.".concat(r,".email"),control:h,rules:{required:!0},render:e=>{var t,s,o;let{field:n}=e;return(0,p.jsx)(rr.y5,{...n,error:b.errors.users&&!!(null===(t=b.errors.users[r])||void 0===t?void 0:t.email),errorMessage:b.errors.users&&(null===(o=b.errors.users[r])||void 0===o?void 0:null===(s=o.email)||void 0===s?void 0:s.message),placeholder:"Email"})}})}),(0,p.jsx)(eb.Z,{sx:{verticalAlign:"top"},children:(0,p.jsx)(j.Qr,{name:"users.".concat(r,".userKind"),control:h,render:e=>{var t,s;let{field:o}=e;return(0,p.jsxs)(rr.ul,{...o,sx:{width:"100%"},inputProps:{sx:{height:"none"}},defaultValue:T.VF.Student,error:!!(null===(s=b.errors.users)||void 0===s?void 0:null===(t=s[r])||void 0===t?void 0:t.userKind),children:[(0,p.jsx)(eo.Z,{value:T.VF.Student,children:"Student"}),(0,p.jsx)(eo.Z,{value:T.VF.Teacher,children:"Teacher"})]})}})}),(0,p.jsx)(eb.Z,{colSpan:2,sx:{maxWidth:"600px"},children:(0,p.jsx)(j.Qr,{name:"users.".concat(r,".allocatedEntities"),control:h,render:e=>{var t,s,i,l,c,d,u,x;let{field:h}=e;return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(rr.ul,{multiple:!0,...h,error:!!(null===(s=b.errors.users)||void 0===s?void 0:null===(t=s[r])||void 0===t?void 0:t.allocatedEntities),errorMessage:(null===(c=b.errors.users)||void 0===c?void 0:null===(l=c[r])||void 0===l?void 0:null===(i=l.allocatedEntities)||void 0===i?void 0:i.type)==="too_big"?"You may only choose ".concat(n," course").concat(n>1?"s":""):null===(x=b.errors.users)||void 0===x?void 0:null===(u=x[r])||void 0===u?void 0:null===(d=u.allocatedEntities)||void 0===d?void 0:d.message,sx:{width:"100%",height:"auto",minHeight:"44px"},renderValue:e=>(0,p.jsx)(er.Z,{sx:{display:"flex",flexWrap:"wrap",rowGap:.5},children:e.map(e=>{var r;return(0,p.jsx)(rs,{type:a,children:null===(r=o.find(r=>r.id===e))||void 0===r?void 0:r.name},e)})}),inputProps:{sx:{height:"none"}},children:o.map(e=>(0,p.jsx)(eo.Z,{value:e.id,children:e.name},e.id))})})}})}),0!==r&&(0,p.jsx)(eb.Z,{width:x.spacing(5),sx:{verticalAlign:"top"},children:(0,p.jsx)(e0.Z,{onClick:()=>C(r),sx:{marginTop:x.spacing(.75)},children:(0,p.jsx)(e9.Z,{fontSize:"small"})})})]},e.id))})]})}),(0,p.jsxs)(y.Z,{children:[(0,p.jsxs)(y.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,p.jsx)(w.Z,{onClick:()=>I({email:"",userKind:T.VF.Student,allocatedEntities:[]}),disabled:S.length+l>=i,variant:"link-sm",startIcon:(0,p.jsx)(re.Z,{fontSize:"small",sx:{marginRight:x.spacing(.5)}}),children:"Add another user"}),(0,p.jsxs)(A.Vp,{sx:{background:"transparent",border:"1px solid ".concat(x.palette.grey[400])},typographyProps:{color:x.palette.grey[400]},children:[l+S.length," / ",i]})]}),(0,p.jsxs)(y.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,p.jsx)(w.Z,{onClick:()=>{t()},type:"button",variant:"ghost-sm",sx:{borderColor:x.palette.primary[500],width:x.spacing(21.25)},disabled:d,children:"Cancel"}),(0,p.jsx)(w.Z,{disabled:d,type:"submit",variant:"primary-sm",sx:{width:x.spacing(21.25)},children:d?"Loading":"Invite"})]})]})]})})]})})};var rn=t(74501),ri=t(95143);let rl=e=>{let{user:r}=e,t=(0,f.Z)();return(0,p.jsxs)(y.Z,{direction:"row",alignItems:"center",children:[(0,p.jsxs)(eR.Z,{sx:{width:40,height:40,m:1,fontSize:t.typography["p-sm-bold"].fontSize,backgroundColor:t.palette.primary.main,color:t.palette.common.white},children:[r.first_name[0]||"?",r.last_name[0]||"?"]}),(0,p.jsxs)(y.Z,{children:[(0,p.jsx)(Z.Z,{variant:"p-xs-semibold",children:"".concat(r.first_name," ").concat(r.last_name)}),(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:r.email})]})]})},ra=e=>{let{accountActivated:r}=e,t=(0,f.Z)();return(0,p.jsx)(A.Vp,{sx:{backgroundColor:"transparent",color:r?t.palette.success[500]:t.palette.error[400],border:"1px solid ".concat(r?t.palette.success[500]:t.palette.error[400]),textAlign:"center",display:"inline-block",borderRadius:t.spacing(.5)},typographyProps:{textTransform:"none"},children:r?"Account Activated":"Invite Pending"})};var rc=t(12195),rd=t(43337);let ru=e=>{let{open:r,onClose:t,user:s,maxEntities:o,allowedEntities:n,existingEntities:i,handleRemoveUser:l,handleUpdateUserAccess:a,handleResendInvite:c,isLoading:d}=e,u=(0,f.Z)(),x=m.z.object({allocatedEntities:m.z.string().array().max(o)}),{handleSubmit:h,control:g,formState:{errors:b}}=(0,j.cI)({defaultValues:{allocatedEntities:i},resolver:(0,v.F)(x)}),S=async e=>{a(e.allocatedEntities)};return(0,p.jsx)(A.u_,{open:r,onClose:t,analyticsName:"manage-single-user-modal",children:(0,p.jsxs)(e7.Z,{sx:{p:4,maxHeight:"80vh",overflowY:"auto",background:u.palette.background.default,width:{xs:"100vw",md:"80vw",lg:"50vw"},maxWidth:u.spacing(150),position:"relative"},children:[(0,p.jsx)(e0.Z,{onClick:t,sx:{position:"absolute",right:u.spacing(2),top:u.spacing(2)},children:(0,p.jsx)(rc.Z,{fontSize:"small"})}),(0,p.jsx)(Z.Z,{variant:"h5-semibold",sx:{textAlign:"left"},children:"Edit Access For User"}),(0,p.jsxs)(y.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,p.jsx)(rl,{user:s}),(0,p.jsxs)(y.Z,{spacing:.5,children:[(0,p.jsx)(ra,{accountActivated:s.account_activated}),!s.account_activated&&(0,p.jsxs)(w.Z,{variant:"link-sm",sx:{fontSize:u.spacing(1.5)},color:"primary",onClick:c,disabled:d,children:[(0,p.jsx)(rd.Z,{fontSize:"small",sx:{marginRight:u.spacing(.5)}}),"Resend Invite"]})]})]}),(0,p.jsxs)("form",{onSubmit:h(S),children:[(0,p.jsxs)(Z.Z,{variant:"p-sm-semibold",sx:{marginY:u.spacing(1)},children:["Course(s): choose up to ",o]}),(0,p.jsx)(j.Qr,{name:"allocatedEntities",control:g,render:e=>{var r,t;let{field:s}=e;return(0,p.jsx)(rr.ul,{variant:"standard",multiple:!0,...s,error:!!b.allocatedEntities,errorMessage:(null===(r=b.allocatedEntities)||void 0===r?void 0:r.type)==="too_big"?"You may only choose ".concat(o," course").concat(o>1?"s":""):null===(t=b.allocatedEntities)||void 0===t?void 0:t.message,sx:{width:"100%"},renderValue:e=>e.map(e=>{var r;return(0,p.jsx)(rs,{children:null===(r=n.find(r=>r.id===e))||void 0===r?void 0:r.name},e)}),children:n.map(e=>(0,p.jsx)(eo.Z,{value:e.id,children:e.name},e.id))})}}),(0,p.jsxs)(y.Z,{direction:"row",spacing:1,justifyContent:"flex-end",marginTop:u.spacing(2),children:[(0,p.jsxs)(w.Z,{variant:"ghost-sm",onClick:l,disabled:d,sx:{color:u.palette.error[500],width:u.spacing(20)},children:[(0,p.jsx)(e9.Z,{fontSize:"small",sx:{marginRight:u.spacing(.5)}}),"Remove Access"]}),(0,p.jsx)(w.Z,{variant:"primary-sm",type:"submit",disabled:d,sx:{width:u.spacing(20)},children:"Update"})]})]})]})})};var rx=t(75652),rp=t.n(rx),rh=t(50131);let rm=F.kg.child({from:"DealCohortUsers"}),rg=async(e,r)=>{let{data:{dealCohort:t}}=await e.access.query({query:e3.d9,variables:{id:r}}),s=rp()(t.seats.map(e=>e.userId)),{data:{data:o}}=await e.users.searchUsers({filter:{withIds:s}});return{seats:t.seats,users:o}},rb=e=>{let{dealCohort:r,seat:t,user:s,refetchDealCohort:o,refetchDealCohortSeats:n,allowedEntities:i,maxEntities:l}=e,{contentHierarchy:a}=(0,O.kt)(),[c,u]=(0,h.useState)(!1),[x]=(0,eX.D)(e3.wm),[m]=(0,eX.D)(e3.qf),{api:g}=(0,R.Qy)(),b=t.seatAllocatedEntities.map(e=>e.seatAllowedEntityId),j=()=>{u(!1)},{isLoading:v,mutate:f}=(0,eB.useMutation)({mutationFn:async()=>{try{if(!confirm("Are you sure you want to remove access for this user?"))return;await m({variables:{input:{dealCohortId:r.id,seatId:t.id}}}),await o(),await n(),j()}catch(e){rm.error("Failed to remove user from seat",{error:e}),P.A9.error(e.message||"Something went wrong, please try again later")}}}),{isLoading:Z,mutate:w}=(0,eB.useMutation)({mutationFn:async e=>{let t=b.filter(r=>!e.includes(r)),i=e.filter(e=>!b.includes(e));if(!i.length&&!t.length)return P.A9.info("No changes were made to the user");try{await x({variables:{input:{dealCohortId:r.id,usersToAllocateTo:[{userId:s.id,allowedEntitiesToAdd:i,allowedEntitiesToRemove:t}]}}}),await o(),await n(),P.A9.success("User access updated"),j()}catch(e){rm.error("Failed to update user access",{error:e}),P.A9.error(e.message||"Something went wrong, please try again later")}}}),{mutate:S,isLoading:I}=(0,eB.useMutation)(async()=>{try{await g.users.resendActivation(s.id),P.A9.info("Invite resent")}catch(e){rm.error("Failed to resend invite",{error:e}),P.A9.error(e.message||"Something went wrong, please try again later")}}),C=v||Z||I;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ru,{open:c,user:s,onClose:j,allowedEntities:i,maxEntities:l,existingEntities:b,handleRemoveUser:f,handleResendInvite:S,handleUpdateUserAccess:w,isLoading:C}),(0,p.jsxs)(eg.Z,{children:[(0,p.jsx)(eb.Z,{children:(0,p.jsx)(rl,{user:s})}),(0,p.jsx)(eb.Z,{children:(0,p.jsx)(y.Z,{direction:"row",spacing:1,children:t.seatAllocatedEntities.map(e=>{var t,s,o;let n=r.seatAllowedEntities.find(r=>{let{id:t}=r;return e.seatAllowedEntityId===t});if(!n)return null;let i=null!==(o=null===(t=n.productVariant)||void 0===t?void 0:t.product.entityId)&&void 0!==o?o:null===(s=n.subscriptionProductVariant)||void 0===s?void 0:s.subscriptionProduct.entityId;if(!i)return null;if(n.entityType===ev.D5.ProductVariant){let e=(0,O.ev)(a,i);if(!e)return null;let r=(0,O.Ft)(a,e.parent_id);return r?(0,p.jsxs)(rs,{type:d.Product,children:[r.name," ",e.short_name]},e.id):null}let l=(0,O.Ft)(a,i);return l?(0,p.jsx)(rs,{type:d.Subscription,children:l.name},l.id):null})})}),(0,p.jsx)(eb.Z,{align:"right",children:(0,p.jsx)(ra,{accountActivated:s.account_activated})}),(0,p.jsx)(eb.Z,{align:"right",children:(0,p.jsxs)(y.Z,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-end",children:[(0,p.jsx)(e$.Z,{title:"Remove User Access",children:(0,p.jsx)(e0.Z,{onClick:()=>f(),disabled:v,children:(0,p.jsx)(rn.Z,{fontSize:"small"})})}),(0,p.jsx)(e$.Z,{title:"Edit User Access",children:(0,p.jsx)(e0.Z,{disabled:v,onClick:()=>{u(!0)},children:(0,p.jsx)(ri.Z,{fontSize:"small"})})})]})})]})]})},rj=e=>{let{dealCohort:r,refetchDealCohort:t,allowedEntities:s}=e,{api:o}=(0,R.Qy)(),{data:n,refetch:i,isLoading:l}=(0,eB.useQuery)(R.iP.dealCohortSeats(r.id),async()=>rg(o,r.id));return(0,p.jsxs)(p.Fragment,{children:[l&&(0,p.jsx)(eg.Z,{children:(0,p.jsx)(eb.Z,{colSpan:4,children:(0,p.jsx)(y.Z,{justifyContent:"center",alignItems:"center",children:(0,p.jsx)(rh.TK,{sx:{height:"24px",width:"24px"}})})})}),!l&&!!(null==n?void 0:n.seats.length)&&n.seats.map(e=>{let o=null==n?void 0:n.users.find(r=>r.id===e.userId);return o?(0,p.jsx)(rb,{refetchDealCohort:t,refetchDealCohortSeats:i,user:o,seat:e,dealCohort:r,allowedEntities:s,maxEntities:r.maxEntitiesPerSeat},e.id):null})]})},rv=F.kg.child({from:"DealCohortRow"}),rf=e=>{let{dealCohort:r,refetchDealCohort:t}=e,[s,o]=(0,h.useState)(!1),[n,i]=(0,h.useState)(!1),{contentHierarchy:l}=(0,O.kt)(),{api:a}=(0,R.Qy)(),c=(0,f.Z)(),{requestUserSeatsUrl:u}=(0,E.JR)(),x=r.seatAllowedEntities.some(e=>e.entityType===ev.D5.SubscriptionProductVariant),m=r.seatAllowedEntities.some(e=>e.entityType===ev.D5.ProductVariant),g=r.seatAllowedEntities.map(e=>{var r,t,s,o,n,i;let a=e.productVariant?(0,O.ev)(l,null!==(t=e.productVariant.product.entityId)&&void 0!==t?t:""):null,c=null!==(s=null===(r=e.subscriptionProductVariant)||void 0===r?void 0:r.subscriptionProduct.entityId)&&void 0!==s?s:null==a?void 0:a.parent_id,d=(0,O.Ft)(l,null!=c?c:""),u=(0,O.p8)(l,null!==(o=null==d?void 0:d.parent_id)&&void 0!==o?o:""),x=(0,O.FT)(l,null!==(n=null==u?void 0:u.parent_id)&&void 0!==n?n:"");return{type:e.entityType,allowedEntityId:e.id,subjectGroupName:null!==(i=null==d?void 0:d.name)&&void 0!==i?i:"",subjectGroupId:c,entityName:a?"".concat(null==x?void 0:x.short_name," - ").concat(null==d?void 0:d.name," ").concat(null==a?void 0:a.short_name):"".concat(null==x?void 0:x.short_name," - ").concat(null==d?void 0:d.name," Educator Pro")}}),b=eQ()(r.seatAllowedEntities.map(e=>{var r,t,s,o,n,i,a;let c=null!==(i=null!==(n=null===(r=e.subscriptionProductVariant)||void 0===r?void 0:r.subscriptionProduct.entityId)&&void 0!==n?n:null===(t=(0,O.ev)(l,null!==(o=null===(s=e.productVariant)||void 0===s?void 0:s.product.entityId)&&void 0!==o?o:""))||void 0===t?void 0:t.parent_id)&&void 0!==i?i:"",d=(0,O.Ft)(l,c);return{type:e.entityType,id:e.id,name:null!==(a=null==d?void 0:d.name)&&void 0!==a?a:"",subjectGroupId:c}}).filter(e=>""!==e.name),e=>"".concat(e.subjectGroupId,"-").concat(e.type)),j=b.slice(0,b.length<=3?3:2).map(e=>(0,p.jsx)(rs,{type:e.type===ev.D5.SubscriptionProductVariant?d.Subscription:d.Product,children:(0,p.jsx)(y.Z,{alignItems:"center",children:e.name})},e.id));b.length>3&&j.push((0,p.jsx)(rs,{type:x?d.Subscription:d.Product,children:(0,p.jsxs)(y.Z,{alignItems:"center",direction:"row",children:["+",b.length-2," more",(0,p.jsx)(e$.Z,{title:b.slice(2).map(e=>{let{name:r}=e;return r}).join(", "),sx:{marginLeft:c.spacing(.5)},children:(0,p.jsx)(e5.Z,{fontSize:"inherit"})})]})},3));let[v,{loading:S}]=(0,eX.D)(e3.wm),{mutate:I,isLoading:C}=(0,eB.useMutation)({mutationFn:async e=>{try{let{data:{data:n}}=await a.users.searchUsers({filter:{withEmails:e.map(e=>e.email.toLowerCase())}}),l=e.filter(e=>!n.some(r=>r.email===e.email.toLowerCase())),c=await Promise.all(l.map(async e=>{let{data:r}=await a.users.registerUser({email:e.email,first_name:"",last_name:"",kind:e.userKind});return r})),d=[...n,...c],u=e.map(e=>{let r=d.find(r=>r.email===e.email.toLowerCase());if(!r)throw rv.warn("User not found",{email:e.email}),Error("User not found");return{userId:r.id,allowedEntitiesToAdd:e.allocatedEntities,allowedEntitiesToRemove:[]}});await v({variables:{input:{dealCohortId:r.id,usersToAllocateTo:u}}}),t(),i(!1),s||o(!0),P.A9.success("Users invited successfully")}catch(e){rv.error("Failed to invite users",{error:e}),P.A9.error(e.message||"Something went wrong, please try again later")}}});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ro,{open:n,onClose:()=>i(!1),dealCohortName:r.name,dealCohortId:r.id,allowedEntities:g.sort((e,r)=>e.entityName<r.entityName?-1:e.entityName>r.entityName?1:0).map(e=>({id:e.allowedEntityId,name:e.entityName})),maxEntities:r.maxEntitiesPerSeat,assignedSeats:r.assignedSeats,totalSeatsAvailable:r.maxSeats,type:m?d.Product:d.Subscription,assignUsers:I,isLoading:C||S}),(0,p.jsxs)(eg.Z,{sx:{"&&&":{borderBottom:"none"},td:{borderBottom:"none"}},children:[(0,p.jsx)(eb.Z,{children:(0,p.jsxs)(y.Z,{children:[(0,p.jsx)(Z.Z,{variant:"p-md-bold",children:r.name}),(0,p.jsx)(Z.Z,{variant:"p-xs-rg",children:(0,p.jsxs)("time",{suppressHydrationWarning:!0,dateTime:r.expiryDate,children:["Expiry ",eK.ou.fromISO(r.expiryDate).toLocaleString()]})})]})}),(0,p.jsx)(eb.Z,{children:(0,p.jsx)(rs,{type:d.Default,children:m?"".concat(r.maxEntitiesPerSeat," Courses"):"Educator Pro"})}),(0,p.jsx)(eb.Z,{children:(0,p.jsx)(y.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:j})}),(0,p.jsx)(eb.Z,{children:(0,p.jsxs)(Z.Z,{variant:"p-xs-rg",children:[r.maxSeats-r.assignedSeats," of ",r.maxSeats," seats remaining"]})}),(0,p.jsx)(eb.Z,{align:"right",children:r.maxSeats===r.assignedSeats?(0,p.jsx)(e$.Z,{title:"You are out of seats, you can request more here.",children:(0,p.jsx)(w.Z,{variant:"ghost-sm",color:"primary",onClick:()=>void 0,sx:{fontSize:c.spacing(1.5),borderColor:c.palette.primary.main,textAlign:"center"},LinkComponent:eJ(),href:u,target:"_blank",children:"Request More"})}):(0,p.jsxs)(w.Z,{variant:"ghost-sm",color:"primary",onClick:()=>{i(!0)},sx:{fontSize:c.spacing(1.5),borderColor:c.palette.primary.main},children:[(0,p.jsx)(e4.Z,{fontSize:"small",sx:{height:c.spacing(2),width:c.spacing(2)}}),"Add Users"]})}),(0,p.jsx)(eb.Z,{children:(0,p.jsx)(e0.Z,{onClick:()=>o(e=>!e),children:s?(0,p.jsx)(e6.Z,{fontSize:"small"}):(0,p.jsx)(e8.Z,{fontSize:"small"})})})]}),(0,p.jsx)(eg.Z,{children:(0,p.jsx)(eb.Z,{colSpan:6,sx:{paddingY:0},children:(0,p.jsx)(e1.Z,{in:s,timeout:"auto",unmountOnExit:!0,children:0===r.assignedSeats?(0,p.jsx)(Z.Z,{variant:"p-sm-rg",sx:{color:c.palette.grey[400],pb:c.spacing(2)},children:"No users have been added to this cohort yet."}):(0,p.jsx)(e2.Z,{sx:{tr:{background:c.palette.background.default},td:{borderBottom:"none",padding:c.spacing(1)}},children:(0,p.jsx)(eh.Z,{sx:{borderSpacing:c.spacing(0,1),borderCollapse:"separate"},children:(0,p.jsx)(rj,{dealCohort:r,allowedEntities:g.map(e=>({id:e.allowedEntityId,name:e.entityName})),refetchDealCohort:t})})})})})})]})};var ry=t(88896),rZ=t(62301),rw=t(88459),rS=t(59568),rI=t(94045);let rC=e=>{let r=(0,f.Z)(),{subjectSuperGroupList:t,handleSubjectSuperGroupSelect:s,selectedSubjects:o,subjectSuperGroupSubjectLimits:n}=e;return(0,p.jsx)(y.Z,{spacing:{xs:2,md:5},divider:(0,p.jsx)(ry.Z,{flexItem:!0,sx:{display:{md:"none"}}}),children:t.map(e=>{let{superGroupKey:t,groups:i,tips:l}=e,a=o[t].all;return(0,p.jsxs)(y.Z,{width:{xs:"100%",lg:"560px"},children:[(0,p.jsxs)(rZ.Z,{sx:{display:{xs:"block",md:"none"},bgcolor:"transparent"},disableGutters:!0,elevation:0,children:[(0,p.jsxs)(rw.Z,{expandIcon:(0,p.jsx)(rI.Z,{sx:{color:r.colors.textIcon.info}}),sx:{bgcolor:"transparent",px:0,minHeight:"auto","& .MuiAccordionSummary-content":{alignItems:"center",justifyContent:"space-between",gap:2,pr:2,m:0,my:0}},children:[(0,p.jsx)(Z.Z,{variant:"p-md-semibold",color:r.colors.textIcon.primary,children:t}),(0,p.jsxs)(Z.Z,{variant:"p-xs-rg",color:r.colors.textIcon.info,children:[a.length," / ",n[t]]})]}),(0,p.jsx)(rS.Z,{sx:{p:0,pt:2},children:(0,p.jsxs)(y.Z,{spacing:1,children:[l&&(0,p.jsx)(rE,{}),(0,p.jsx)(rk,{superGroupKey:t,groups:i,subjectIds:a,onSelect:s})]})})]}),(0,p.jsxs)(y.Z,{spacing:2,display:{xs:"none",md:"flex"},children:[(0,p.jsxs)(y.Z,{flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",md:"center"},children:[(0,p.jsxs)(y.Z,{flexDirection:"row",alignItems:"center",gap:2,children:[(0,p.jsx)(Z.Z,{variant:"p-md-semibold",color:r.colors.textIcon.sub,children:t}),(0,p.jsxs)(Z.Z,{variant:"p-xs-rg",color:r.colors.textIcon.info,children:[a.length," / ",n[t]]})]}),l&&(0,p.jsx)(rE,{})]}),(0,p.jsx)(rk,{superGroupKey:t,groups:i,subjectIds:a,onSelect:s})]})]},t)})})},rk=e=>{let{superGroupKey:r,groups:t,subjectIds:s,onSelect:o}=e,n=(0,f.Z)();return(0,p.jsx)(y.Z,{gap:2,flexDirection:{lg:"row",xs:"column"},flexWrap:{lg:"wrap"},width:"100%",children:t.map(e=>{let{groupTitle:t,items:i,groupIcon:l}=e;return(0,p.jsxs)(M.Z,{sx:{width:{lg:"272px",xs:"100%"},p:2,bgcolor:n.colors.ui.bg_panel,borderRadius:"16px",label:{m:0}},children:[(0,p.jsxs)(y.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:2.5,children:[(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",children:t}),(0,h.cloneElement)(l,{sx:{width:"40px",height:"40px"}})]}),(0,p.jsx)(S.ZP,{container:!0,spacing:1,children:i.map(e=>{let t=s.includes(e.id);return(0,p.jsx)(S.ZP,{item:!0,xs:12,children:(0,p.jsx)(L.Z,{sx:{border:"1px solid",borderRadius:"8px",borderColor:t?n.colors.textIcon.info:n.colors.ui.border,height:"44px",width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},label:(0,p.jsxs)(y.Z,{direction:"row",gap:2,alignItems:"center",justifyContent:"space-between",width:"100%",pr:1.5,children:[(0,p.jsx)(Z.Z,{variant:"p-sm-rg",display:{xs:"none",md:"block"},children:e.label}),(0,p.jsx)(Z.Z,{variant:"p-sm-rg",display:{xs:"block",md:"none"},children:e.label.replace("SL","Standard Level").replace("HL","Higher Level")}),e.isFreeTrial?(0,p.jsx)(eT.pW,{}):e.isGold?(0,p.jsx)(eT.Ei,{}):null]}),control:(0,p.jsx)(I.Z,{value:e.id,disabled:e.isGold,onChange:(t,s)=>{o(r,e.groupKey,e.id,s)},sx:{p:1.5,pr:1},checked:s.includes(e.id),icon:(0,p.jsx)(_.uF,{sx:{width:"16px",height:"16px"}}),checkedIcon:(0,p.jsx)(_.b2,{sx:{width:"16px",height:"16px"}})})},e.id)},e.id)})})]},t)})})},rE=()=>{let e=(0,f.Z)();return(0,p.jsxs)(y.Z,{flexDirection:"row",alignItems:"center",gap:1,children:[(0,p.jsx)(Z.Z,{variant:"p-xs-rg",color:e.colors.textIcon.placeholder,children:"Not sure which course to select?"}),(0,p.jsx)(e$.Z,{enterTouchDelay:0,leaveTouchDelay:0,componentsProps:{tooltip:{sx:{bgcolor:e.colors.button.sub_hover,width:"200px",p:1}}},title:(0,p.jsxs)(y.Z,{spacing:1,children:[(0,p.jsxs)(Z.Z,{variant:"p-xs-rg",color:e.colors.textIcon.primary,children:[(0,p.jsx)("span",{style:{fontWeight:"bold"},children:"SL - 2025"})," is the appropriate course for students taking their final examinations on or before November 2025."]}),(0,p.jsxs)(Z.Z,{variant:"p-xs-rg",color:e.colors.textIcon.primary,children:[(0,p.jsx)("span",{style:{fontWeight:"bold"},children:"SL - 2026"})," is the appropriate course for students taking their final examinations on or after May 2026."]})]}),children:(0,p.jsx)(y.Z,{children:(0,p.jsx)(_.sz,{sx:{width:"16px",height:"16px"}})})})]})};var rP=t(9850),rA=t.n(rP),rT=t(15656),rN=t(87622),r_=t.n(rN),rF=t(3440),rD=t.n(rF);let rz={[rT._m.MATHEMATICS]:{[rT.bT.MATH]:[],all:[]},[rT._m.SCIENCES]:{[rT.bT.PHYSICS]:[],[rT.bT.BIO]:[],[rT.bT.CHEMISTRY]:[],all:[]},[rT._m.INDIVIDUALS_SOCIETIES]:{[rT.bT.BUSINESS_MNGT]:[],[rT.bT.ECON]:[],[rT.bT.ESS]:[],[rT.bT.PSYCHOLOGY]:[],all:[]},[rT._m.ENGLISH]:{[rT.bT.ENGLISH]:[],all:[]},[rT._m.LANGUAGE_B]:{[rT.bT.ENGLISH_B]:[],[rT.bT.SPANISH_B]:[],[rT.bT.FRENCH_B]:[],all:[]}},rG=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=Object.keys(r).reduce((e,t)=>(r[t].hasAccess&&e.push(t),e),[]),o=rp()([...s,...t]),n=r_()(e,"id"),i=o.map(e=>n[e]),l=rD()(i,"subjectGroupName"),a=e=>{var r;return(null!==(r=l[e])&&void 0!==r?r:[]).map(e=>e.id)},c=a(rT.bT.MATH),d=a(rT.bT.PHYSICS),u=a(rT.bT.BIO),x=a(rT.bT.CHEMISTRY),p=a(rT.bT.BUSINESS_MNGT),h=a(rT.bT.ECON),m=a(rT.bT.ESS),g=a(rT.bT.PSYCHOLOGY),b=a(rT.bT.ENGLISH),j=a(rT.bT.ENGLISH_B),v=a(rT.bT.SPANISH_B),f=a(rT.bT.FRENCH_B);return{[rT._m.MATHEMATICS]:{[rT.bT.MATH]:c,all:[...c]},[rT._m.SCIENCES]:{[rT.bT.PHYSICS]:d,[rT.bT.BIO]:u,[rT.bT.CHEMISTRY]:x,all:[...d,...u,...x]},[rT._m.INDIVIDUALS_SOCIETIES]:{[rT.bT.BUSINESS_MNGT]:p,[rT.bT.ECON]:h,[rT.bT.ESS]:m,[rT.bT.PSYCHOLOGY]:g,all:[...p,...h,...m,...g]},[rT._m.ENGLISH]:{[rT.bT.ENGLISH]:b,all:[...b]},[rT._m.LANGUAGE_B]:{[rT.bT.ENGLISH_B]:j,[rT.bT.SPANISH_B]:v,[rT.bT.FRENCH_B]:f,all:[...j,...v,...f]}}};function rM(e,r){var t,s;let{hasAccess:o,isFreeTrial:n}=null!==(t=e[r])&&void 0!==t?t:{};return{isGold:null!=o&&o,isFreeTrial:null!==(s=o&&n)&&void 0!==s&&s}}let rL=(e,r,t)=>{var s,o,n,i,l,a,c,d,u,x,h,m;let g=rD()(e,"subjectGroupName"),b=null!==(s=g.Mathematics)&&void 0!==s?s:[],j="Analysis & Approaches",v="Applications & Interpretation",f=[{groupTitle:j,groupIcon:(0,p.jsx)(_.F8,{}),items:b.filter(e=>e.name.includes(j)).map(e=>({...e,label:e.name.replace(j,"").trim(),groupKey:rT.bT.MATH,...rM(r,e.id)}))},{groupTitle:v,groupIcon:(0,p.jsx)(_.Uu,{}),items:b.filter(e=>e.name.includes(v)).map(e=>({...e,label:e.name.replace(v,"").trim(),groupKey:rT.bT.MATH,...rM(r,e.id)}))}],y=rT.bT.BIO,Z=rT.bT.CHEMISTRY,w=rT.bT.PHYSICS,S=[{groupTitle:y,groupIcon:(0,p.jsx)(_.fI,{}),items:(null!==(o=g[y])&&void 0!==o?o:[]).map(e=>({...e,label:e.name,groupKey:y,...rM(r,e.id)}))},{groupTitle:Z,groupIcon:(0,p.jsx)(_.m7,{}),items:(null!==(n=g[Z])&&void 0!==n?n:[]).map(e=>({...e,label:e.name,groupKey:Z,...rM(r,e.id)}))},{groupTitle:w,groupIcon:(0,p.jsx)(_.In,{}),items:(null!==(i=g[w])&&void 0!==i?i:[]).map(e=>({...e,label:e.name,groupKey:w,...rM(r,e.id)}))}],I=rT.bT.BUSINESS_MNGT,C=rT.bT.ECON,k=rT.bT.ESS,E=rT.bT.PSYCHOLOGY,P=[{groupTitle:I,groupIcon:(0,p.jsx)(_.KJ,{}),items:(null!==(l=g[I])&&void 0!==l?l:[]).map(e=>({...e,label:e.name,groupKey:I,...rM(r,e.id)}))},{groupTitle:C,groupIcon:(0,p.jsx)(_.Xf,{}),items:(null!==(a=g[C])&&void 0!==a?a:[]).map(e=>({...e,label:e.name,groupKey:C,...rM(r,e.id)}))},{groupTitle:k,groupIcon:(0,p.jsx)(_._4,{}),items:(null!==(c=g[k])&&void 0!==c?c:[]).map(e=>({...e,label:e.name,groupKey:k,...rM(r,e.id)}))},{groupTitle:E,groupIcon:(0,p.jsx)(_.bv,{}),items:(null!==(d=g[E])&&void 0!==d?d:[]).map(e=>({...e,label:e.name,groupKey:E,...rM(r,e.id)}))}],A=rT.bT.ENGLISH_B,T=rT.bT.SPANISH_B,N=rT.bT.FRENCH_B,F=[{groupTitle:A,groupIcon:(0,p.jsx)(_.KG,{}),items:(null!==(u=g[A])&&void 0!==u?u:[]).map(e=>({...e,label:e.name,groupKey:A,...rM(r,e.id)}))},{groupTitle:T,groupIcon:(0,p.jsx)(_.PV,{}),items:(null!==(x=g[T])&&void 0!==x?x:[]).map(e=>({...e,label:e.name,groupKey:T,...rM(r,e.id)}))},{groupTitle:N,groupIcon:(0,p.jsx)(_.cj,{}),items:(null!==(h=g[N])&&void 0!==h?h:[]).map(e=>({...e,label:e.name,groupKey:N,...rM(r,e.id)}))}],D=null!==(m=g.English)&&void 0!==m?m:[],z="Language & Literature",G="Literature",M=[{groupTitle:z,groupIcon:(0,p.jsx)(_.tU,{}),items:D.filter(e=>e.name.includes(z)).map(e=>({...e,label:e.name.replace(z,"").trim(),groupKey:rT.bT.ENGLISH,...rM(r,e.id)}))},{groupTitle:G,groupIcon:(0,p.jsx)(_.Jf,{}),items:D.filter(e=>!e.name.includes(z)).map(e=>({...e,label:e.name.replace(G,"").trim(),groupKey:rT.bT.ENGLISH,...rM(r,e.id)}))}],L={[rT._m.MATHEMATICS]:f,[rT._m.SCIENCES]:S,[rT._m.INDIVIDUALS_SOCIETIES]:P,[rT._m.ENGLISH]:M,[rT._m.LANGUAGE_B]:F},V=[rT._m.INDIVIDUALS_SOCIETIES];return t.map(e=>({superGroupKey:e,groups:L[e],tips:V.includes(e)}))},rV=F.kg.child({from:"useSubjectPicker"}),rR=e=>{var r;let{flowType:t,subjects:s,subjectAccess:o={},initialSubjects:n=[],subjectSuperGroupsVisible:i,onSubmit:l}=e,{contentHierarchy:c}=(0,O.kt)(),[d,u]=(0,h.useState)(t===a.OnBoarding?rz:rG(s,o,n)),[x,p]=(0,h.useState)(!1),m=c.curricula.find(e=>"IB"===e.short_name),g=null!==(r=null==m?void 0:m.subjectSuperGroups)&&void 0!==r?r:[],b=g.reduce((e,r)=>(e[r.name]=r.max_subjects,e),{}),j=null!=i?i:g.map(e=>e.name),v=(0,h.useMemo)(()=>rL(s,o,j),[o,s,j]),f=async()=>{try{p(!0);let e=g.flatMap(e=>e.subjectGroups.flatMap(e=>e.subjects).map(e=>e.id)),r=n.filter(r=>!e.includes(r)),t=[...d[rT._m.MATHEMATICS].all,...d[rT._m.SCIENCES].all,...d[rT._m.INDIVIDUALS_SOCIETIES].all,...d[rT._m.ENGLISH].all,...d[rT._m.LANGUAGE_B].all];await (null==l?void 0:l([...r,...t])),p(!1)}catch(e){p(!1),P.A9.error("Something went wrong. Please try again later"),rV.error("Failed to update subjects",{error:e})}};return{selectedSubjects:d,setSelectedSubjects:u,subjectSuperGroupList:v,handleSubjectSuperGroupSelect:(e,r,s,n)=>{u(i=>{let l=rA()(i[e]),c=b[e],{all:d,...u}=l,x=!1===n;if(t===a.OnBoarding){if(x)z()(u[r],e=>e===s),z()(d,e=>e===s);else if(u[r].length){let e=u[r][0];u[r]=[s],z()(d,r=>r===e),d.push(s)}else if(d.length>=c){let e=d.shift();d.push(s);let t=Object.keys(u).find(r=>u[r].includes(e));z()(u[t],r=>r===e),u[r].push(s)}else d.push(s),u[r].push(s)}else if(x)z()(u[r],e=>e===s),z()(d,e=>e===s);else{if(d.length>c)return P.A9.warn("You can only select ".concat(c," course(s) for ").concat(e,", please deselect one for reselect.")),i;if(u[r].length){let t=o?u[r].filter(e=>{var r;return(null===(r=o[e])||void 0===r?void 0:r.hasAccess)!==!0}):u[r];if(!t.length)return P.A9.warn("Please contact us(link down below) if you like to select more courses for ".concat(e)),i;let n=t[0];z()(u[r],e=>e===n),z()(d,e=>e===n),u[r].push(s),d.push(s)}else if(d.length===c){let t=o?d.filter(e=>{var r;return(null===(r=o[e])||void 0===r?void 0:r.hasAccess)!==!0}):d;if(!t.length)return P.A9.warn("Please contact us(link down below) if you like to select more courses for ".concat(e)),i;let n=t[0];z()(d,e=>e===n),d.push(s);let l=Object.keys(u).find(e=>u[e].includes(n));z()(u[l],e=>e===n),u[r].push(s)}else d.push(s),u[r].push(s)}return{...i,[e]:{...u,all:d}}})},submit:f,isSubmitting:x,subjectSuperGroupSubjectLimits:b}};var rO=t(78315);function rU(e){if(!e)return e;let r=document.createElement("textarea");return r.innerHTML=e,r.value}(n=u||(u={})).PersonalInfo="Personal Info",n.PasswordAndSecurityForm="Password and Security",n.Subjects="Subjects",n.AcademicInfo="Academic Info";let rH=[{icon:(0,p.jsx)(_.lM,{}),label:"Personal Info",disabled:!0},{icon:(0,p.jsx)(_.mB,{}),label:"Password and Security",disabled:!0},{icon:(0,p.jsx)(_.vJ,{}),label:"Subjects",disabled:!0},{icon:(0,p.jsx)(_.bs,{}),label:"Academic Info",disabled:!0}],rW=e=>{let{activeProfileMenuItem:r,setActiveProfileMenuItem:t}=e,s=(0,f.Z)();return(0,p.jsxs)(y.Z,{zIndex:2,sx:{py:{lg:12,xs:7.5},width:"100%",pb:{xs:3.75},alignItems:{xs:"center",lg:"flex-start"}},gap:6,children:[(0,p.jsx)(Z.Z,{variant:"h2-bold",color:s.colors.textIcon.primary,children:"Account Setup"}),(0,p.jsx)(es.Z,{value:r,IconComponent:ea.Z,sx:{display:{xs:"block",lg:"none"},maxWidth:"450px",background:s.colors.common.brand[50],border:"none",borderRadius:8,height:"48px",width:"100%","& fieldset":{border:"none"},"&>svg":{right:"16px",color:s.colors.button.primary},"&&& .MuiSelect-select":{px:2,py:0,display:"flex",flexDirection:"row",alignItems:"center",height:"48px"},".MuiListItemText-root":{ml:-2}},MenuProps:{MenuListProps:{sx:{py:0}},PaperProps:{sx:{boxShadow:"none",background:s.colors.common.brand[50],borderRadius:4}}},children:rH.map(e=>{let o=e.label===r;return(0,p.jsxs)(eo.Z,{value:e.label,selected:o,disabled:e.disabled,sx:{mb:2.5,px:2.5,borderRadius:"32px",color:s.colors.textIcon.placeholder,height:"48px","&:hover":{color:s.colors.textIcon.primary,backgroundColor:"transparent"},"&&.Mui-selected":{backgroundColor:s.colors.subjectGroup.math[50],color:s.colors.textIcon.primary}},onClick:()=>{t(e.label)},children:[(0,p.jsx)(en.Z,{children:(0,h.cloneElement)(e.icon,{fill:o?s.colors.textIcon.primary:void 0})}),(0,p.jsx)(ei.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-md-semibold",children:e.label})})]},e.label)})}),(0,p.jsx)(el.Z,{sx:{width:"240px",display:{xs:"none",lg:"block"}},children:rH.map(e=>{let o=e.label===r;return(0,p.jsxs)(eo.Z,{selected:o,disabled:e.disabled,sx:{mb:2.5,px:2.5,borderRadius:"32px",color:s.colors.textIcon.placeholder,height:"48px","&:hover":{color:s.colors.textIcon.primary,backgroundColor:"transparent"},"&&.Mui-selected":{backgroundColor:s.colors.subjectGroup.math[50],color:s.colors.textIcon.primary,opacity:1}},onClick:()=>{t(e.label)},children:[(0,p.jsx)(en.Z,{children:(0,h.cloneElement)(e.icon,{fill:o?s.colors.textIcon.primary:void 0})}),(0,p.jsx)(ei.Z,{children:(0,p.jsx)(Z.Z,{variant:"p-md-semibold",children:e.label})})]},e.label)})})]})},rB=e=>{let{subjects:r,onSucc:t,email:s,initialSubjects:o,flowType:n,subjectAccess:i={}}=e,l=(0,f.Z)(),{api:c}=(0,R.Qy)(),d=rR({flowType:n,subjects:r,subjectAccess:i,initialSubjects:o,onSubmit:(0,h.useCallback)(async e=>{let{data:r}=await c.users.updateUser("me",{subjects:e,has_onboarded:!0});P.A9.success("Courses updated successfully!",{autoHideDuration:2e3}),null==t||t(r)},[t,c.users])});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(y.Z,{gap:1,children:[(0,p.jsx)(Z.Z,{variant:"h5-bold",color:l.colors.textIcon.primary,children:"Choose Your Subjects"}),(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:l.colors.textIcon.placeholder,children:"What courses are you studying?"})]}),(0,p.jsx)(rC,{...d}),(0,p.jsxs)(y.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,p.jsxs)(y.Z,{gap:1,children:[(0,p.jsx)(w.Z,{variant:"solid",size:"large",type:"button",disabled:d.isSubmitting,sx:{width:"100%",maxWidth:{xs:"100%",lg:"272px"},justifyContent:"center"},"data-analytics-on":"click","data-analytics-name":"clickUpdateProfileSubmit","data-analytics-attrs":"email:".concat(s),onClick:d.submit,children:(0,p.jsx)(A.aN,{isLoading:d.isSubmitting,size:28,sx:{color:l.colors.textIcon.inverse},children:"Update"})}),(0,p.jsx)(W,{})]}),n===a.OnBoarding&&(0,p.jsx)(H,{})]})]})};var rY=t(99792);let rQ=e=>{var r,t,s;let{initialSubjectIds:o=[],subjectAccess:n={},onSubmit:i}=e,{contentHierarchy:l}=(0,O.kt)(),a=rK(l,n),c=l.curricula.find(e=>"IGCSE"===e.short_name),d=null!==(t=null==c?void 0:c.subjectSuperGroups)&&void 0!==t?t:[],u=d.flatMap(e=>e.subjectGroups.flatMap(e=>e.subjects).map(e=>e.id)),[x,p]=(0,h.useState)(!1),[m,g]=(0,h.useState)(a[0].id),[b,j]=(0,h.useState)(()=>{var e;return null!==(e=o.filter(e=>u.includes(e)))&&void 0!==e?e:[]}),v=null!==(s=null===(r=a.find(e=>e.id===m))||void 0===r?void 0:r.subjectGroups)&&void 0!==s?s:[],f=async()=>{try{var e;p(!0);let r=d.flatMap(e=>e.subjectGroups.flatMap(e=>e.subjects).map(e=>e.id)),t=null!==(e=o.filter(e=>!r.includes(e)))&&void 0!==e?e:[];await (null==i?void 0:i([...t,...b]))}catch(e){P.A9.error("Something went wrong. Please try again later"),F.kg.error("Failed to update subjects",{error:e})}finally{p(!1)}};return{selectedExamBoardId:m,selectedSubjectIds:b,onExamBoardChange:e=>{g(e)},onSubjectClick:e=>{b.includes(e)?j(b.filter(r=>r!==e)):j([...b,e])},examBoardsHierarchyStructure:a,examBoardSubjectGroups:v,submit:f,isSubmitting:x}},rK=(e,r)=>{var t;let s=e.curricula.find(e=>"IGCSE"===e.short_name);return null!==(t=null==s?void 0:s.subjectSuperGroups.map(e=>({id:e.id,name:e.name,subjectGroups:e.subjectGroups.filter(e=>e.status===rY.Vdo.Published).map(e=>({id:e.id,name:e.name,shortName:e.short_name,slug:e.slug,subjects:e.subjects.filter(e=>[rY.AoD.Published,rY.AoD.ComingSoon].includes(e.status)).map(e=>{var t,s;return{id:e.id,name:e.name,shortName:e.short_name,slug:e.slug,isGold:null!==(s=null===(t=r[e.id])||void 0===t?void 0:t.hasAccess)&&void 0!==s&&s,status:e.status}})}))})))&&void 0!==t?t:[]};var rq=t(12667),rJ=t(68696),rX=t(23654);let r$=e=>{let{value:r}=e,t=(0,f.Z)(),{selectedSubjectIds:s,onSubjectClick:o,selectedExamBoardId:n,onExamBoardChange:i,examBoardSubjectGroups:l,examBoardsHierarchyStructure:a}=r;return(0,p.jsxs)(y.Z,{gap:4,children:[(0,p.jsx)(rq.Z,{onChange:(e,r)=>i(r),value:n,sx:{backgroundColor:"#03225414",width:"fit-content",borderRadius:2,padding:.5},TabIndicatorProps:{sx:{display:"none"}},children:a.map(e=>(0,p.jsx)(rJ.Z,{label:e.name,value:e.id,sx:{textTransform:"none",borderRadius:1,px:2,minWidth:"10rem",color:t.colors.textIcon.placeholder,fontWeight:600,"&.Mui-selected":{backgroundColor:t.palette.common.white,borderBottom:"none",color:t.colors.textIcon.standout}}},e.id))}),(0,p.jsx)(S.ZP,{container:!0,spacing:2,children:l.map(e=>e.subjects.map(r=>{let n=(0,U.Ds)(e.slug,r.slug),i=r.isGold||s.includes(r.id),l=r.status===rY.AoD.ComingSoon,a=r.isGold||l;return(0,p.jsx)(S.ZP,{item:!0,xs:12,sm:6,children:(0,p.jsx)(rX.Z,{variant:"outlined",onClick:()=>{a||o(r.id)},sx:{p:2,borderRadius:2,cursor:a?"default":"pointer",borderColor:i?t.colors.button.primary_hover:void 0,"&:hover":{borderColor:a?void 0:t.colors.button.primary_hover}},children:(0,p.jsxs)(y.Z,{spacing:1.5,children:[(0,p.jsxs)(y.Z,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:[n&&(0,p.jsx)(n,{sx:{backgroundColor:(0,U.sO)(t,e.slug)[600],width:"3rem",height:"3rem",p:1,borderRadius:2},fill:t.palette.common.white}),l?(0,p.jsx)(eT.rK,{variant:"p-xs-rg",sx:{backgroundColor:t.colors.common.brand[100],color:t.colors.common.brand[600]}}):(0,p.jsx)(I.Z,{checked:i,icon:(0,p.jsx)(_.IE,{sx:{width:"1rem",height:"1rem"}}),checkedIcon:(0,p.jsx)(_.Fw,{sx:{width:"1rem",height:"1rem"}}),sx:{p:0,"&.Mui-disabled > svg > rect":{fill:t.colors.textIcon.disabled}},disabled:a})]}),(0,p.jsx)(y.Z,{children:(0,p.jsxs)(Z.Z,{variant:"p-md-semibold",color:i?t.colors.textIcon.primary:a?t.colors.textIcon.disabled:t.colors.textIcon.placeholder,children:[e.name,(0,p.jsx)("br",{}),r.name]})})]})})},r.id)}))})]})},r0=e=>{let{onSucc:r,email:t,flowType:s,subjectAccess:o={},initialSubjects:n=[]}=e,i=(0,f.Z)(),{api:l}=(0,R.Qy)(),c=rQ({subjectAccess:o,onSubmit:(0,h.useCallback)(async e=>{let{data:t}=await l.users.updateUser("me",{subjects:e});P.A9.success("Courses updated successfully!",{autoHideDuration:2e3}),null==r||r(t)},[l.users,r]),initialSubjectIds:n});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(y.Z,{gap:1,children:[(0,p.jsx)(Z.Z,{variant:"h5-bold",color:i.colors.textIcon.primary,children:"Choose Your Subjects"}),(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:i.colors.textIcon.placeholder,children:"What courses are you studying?"})]}),(0,p.jsx)(r$,{value:c}),(0,p.jsxs)(y.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,p.jsxs)(y.Z,{gap:1,children:[(0,p.jsx)(w.Z,{variant:"solid",size:"large",type:"button",disabled:c.isSubmitting,sx:{width:"100%",maxWidth:{xs:"100%",lg:"272px"},justifyContent:"center"},"data-analytics-on":"click","data-analytics-name":"clickUpdateProfileSubmit","data-analytics-attrs":"email:".concat(t),onClick:c.submit,children:(0,p.jsx)(A.aN,{isLoading:c.isSubmitting,size:28,sx:{color:i.colors.textIcon.inverse},children:"Update"})}),(0,p.jsx)(W,{})]}),s===a.OnBoarding&&(0,p.jsx)(H,{})]})]})},r1=e=>{let{kind:r,subjectGroups:t,subjects:s,onSucc:o,email:n,flowType:i,initialValues:l,subjectAccess:c,subjectGroupSubscriptionAccess:d}=e,{curriculumName:u}=(0,E.JR)(),x=i===a.OnBoarding?{pl:{lg:14},py:{xs:4,lg:13}}:{};return(0,p.jsx)(y.Z,{...x,gap:5,children:r===T.VF.Student?"IGCSE"===u?(0,p.jsx)(r0,{onSucc:o,email:n,flowType:i,subjectAccess:c,initialSubjects:null==l?void 0:l.subjects}):(0,p.jsx)(rB,{subjects:s,onSucc:o,email:n,flowType:i,initialSubjects:null==l?void 0:l.subjects,subjectAccess:c}):(0,p.jsx)(B,{subjectGroups:t,onSucc:o,email:n,flowType:i,initialSubjectGroups:null==l?void 0:l.subjectGroups,subjectGroupSubscriptionAccess:d})})};var r2=t(95406);let r5=F.kg.child({from:"ResetPassword"}),r4=e=>{let{type:r}=e;switch(r){case"InvalidPasswordException":return(0,p.jsx)(A.kE,{children:"Please enter a valid password"});case"ActivationLinkExpired":return(0,p.jsxs)(A.kE,{children:["This activation link has expired. ",(0,p.jsx)("br",{}),"Please contact support."]});case"ExpiredCodeException":return(0,p.jsxs)(A.kE,{variant:"error",children:["This password reset link has expired. ",(0,p.jsx)("br",{}),(0,p.jsx)(G.Z,{href:"/reset-password-request",style:{textDecorationColor:"#fff"},children:(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",color:"#fff",children:"Click here to request a new password reset link."})})]});case"CodeMismatchException":return(0,p.jsxs)(A.kE,{variant:"error",children:["This password reset link is invalid",(0,p.jsx)(G.Z,{href:"/reset-password-request",style:{textDecorationColor:"#fff"},children:(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",color:"#fff",children:"Click here to request a new password reset link."})})]});default:return null}},r6=m.z.object({password:m.z.string().min(8,"must be at least 8 characters"),confirmPassword:m.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),r8=m.z.object({type:m.z.literal("forgot"),email:m.z.string().email(),code:m.z.string().min(1)}),r3=()=>{let e=(0,f.Z)(),r=(0,ee.useRouter)(),{notFound:t}=(0,rO.bJ)(),{setPassword:s}=(0,eE.aC)(),[o,n]=(0,h.useState)(null),[i,l]=(0,h.useState)(void 0),[a,c]=(0,h.useState)(!1),d=(0,j.cI)({resolver:(0,v.F)(r6),defaultValues:{password:"",confirmPassword:""}});(0,h.useEffect)(()=>{let e=new URLSearchParams(location.search);try{let r=r8.parse({type:e.get("type"),email:e.get("email"),code:rU(e.get("code"))});n(r)}catch(e){r5.warn("Failed to decode setPassword URL params",{error:e}),t()}},[t]);let u=async e=>{if(l(void 0),c(!0),!o)return;let{password:t}=e,{email:n,code:i,type:a}=o;try{await s(a,n,i,t),r.push("/dashboard")}catch(e){switch(c(!1),e.name){case"CodeMismatchException":l("CodeMismatchException");break;case"ExpiredCodeException":l("ExpiredCodeException");break;case"InvalidPasswordException":l("InvalidPasswordException");break;default:r5.warn("Failed to set password",{error:e}),P.A9.error("Something went wrong. Please try again later")}}},x=null==o?void 0:o.email,m=null==o?void 0:o.type;return(0,p.jsx)(r2.V6,{children:(0,p.jsx)(et.Z,{children:(0,p.jsxs)(y.Z,{spacing:i?2:4,margin:"auto",mt:12,sx:{width:e.spacing(45),maxWidth:"100%"},children:[(0,p.jsx)(y.Z,{alignItems:"center",mb:i?2:0,children:(0,p.jsx)(Z.Z,{variant:"h2-semibold",color:e.palette.common.black,children:"Set new password"})}),(0,p.jsx)(r4,{type:i}),(0,p.jsx)(j.RV,{...d,children:(0,p.jsxs)("form",{onSubmit:d.handleSubmit(u),children:[(0,p.jsxs)(y.Z,{spacing:2.5,children:[(0,p.jsx)(rr.PV,{name:"password",label:"Password",type:"password",placeholder:"Enter your password",readOnly:a}),(0,p.jsx)(rr.PV,{name:"confirmPassword",label:"Confirm password",type:"password",placeholder:"Enter your password again",readOnly:a})]}),(0,p.jsx)(A.zx,{variant:"primary-md",type:"submit",disabled:a,sx:{mt:3},"data-analytics-on":"click","data-analytics-name":"clickSetPasswordSubmit","data-analytics-attrs":"email:".concat(x,",type:").concat(m),fullWidth:!0,children:(0,p.jsx)(A.aN,{isLoading:a,size:20,sx:{margin:"auto",mt:.5,color:"#fff"},children:"Submit"})})]})})]})})})},r7=e=>{let{type:r}=e;switch(r){case"InvalidPasswordException":return(0,p.jsx)(eT.kE,{children:"Please enter a valid password"});case"ActivationLinkExpired":return(0,p.jsxs)(eT.kE,{children:["This activation link has expired. ",(0,p.jsx)("br",{}),"Please contact support."]});case"ExpiredCodeException":return(0,p.jsxs)(eT.kE,{variant:"error",children:["This password reset link has expired. ",(0,p.jsx)("br",{}),(0,p.jsx)(G.Z,{href:"/reset-password-request",style:{textDecorationColor:"#fff"},children:(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",color:"#fff",children:"Click here to request a new password reset link."})})]});case"CodeMismatchException":return(0,p.jsxs)(eT.kE,{variant:"error",children:["This password reset link is invalid",(0,p.jsx)(G.Z,{href:"/reset-password-request",style:{textDecorationColor:"#fff"},children:(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",color:"#fff",children:"Click here to request a new password reset link."})})]});default:return null}},r9=F.kg.child({from:"PasswordSetup"}),te=e=>{let r=(0,f.Z)(),{api:t}=(0,R.Qy)(),{setPassword:s}=(0,eE.aC)(),{notFound:o}=(0,rO.bJ)(),[n,i]=(0,h.useState)(void 0),[l,a]=(0,h.useState)(!1),c=(0,j.cI)({resolver:(0,v.F)(r6),defaultValues:{password:"",confirmPassword:""}}),d=async r=>{i(void 0),a(!0);let{password:n}=r,{email:l,code:c,type:d}=e;try{var u,x;await s(d,l,c,n);let{data:r}=await t.users.getUser("me");null===(u=e.onSucc)||void 0===u||u.call(e,null!==(x=r.kind)&&void 0!==x?x:T.VF.Student)}catch(e){switch(a(!1),e.name){case"InvalidPasswordException":i("InvalidPasswordException");break;case"UserNotFoundException":case"NotAuthorizedException":i("ActivationLinkExpired"),r9.warn("ActivationLinkExpired",{error:e,username:l,code:c});break;case"InvalidChallengeException":o();break;default:r9.warn("Failed to set password",{error:e}),P.A9.error("Something went wrong. Please try again later")}}},{email:u,type:x}=e;return(0,p.jsx)(et.Z,{children:(0,p.jsxs)(y.Z,{spacing:n?2:4,margin:"auto",mt:13,sx:{width:r.spacing(45),maxWidth:"100%"},children:[(0,p.jsx)(y.Z,{mb:n?2:0,children:(0,p.jsx)(Z.Z,{variant:"h5-bold",color:r.colors.textIcon.primary,children:"Password Setup"})}),(0,p.jsx)(r7,{type:n}),(0,p.jsx)(j.RV,{...c,children:(0,p.jsxs)("form",{onSubmit:c.handleSubmit(d),children:[(0,p.jsxs)(y.Z,{spacing:3.75,sx:{"label .MuiTypography-root":{fontWeight:600}},children:[(0,p.jsx)(N.PV,{variant:"inverse",name:"password",label:"Password",type:"password",placeholder:"Enter your password",readOnly:l}),(0,p.jsx)(N.PV,{name:"confirmPassword",label:"Confirm password",type:"password",placeholder:"Enter your password again",readOnly:l,variant:"inverse"})]}),(0,p.jsx)(w.Z,{variant:"solid",size:"large",type:"submit",disabled:l,sx:{my:4.75,maxWidth:{xs:"100%",lg:"272px"}},"data-analytics-on":"click","data-analytics-name":"clickSetPasswordSubmit","data-analytics-attrs":"email:".concat(u,",type:").concat(x),fullWidth:!0,children:(0,p.jsx)(A.aN,{isLoading:l,size:24,sx:{margin:"auto",mt:.5,color:r.colors.textIcon.inverse},children:"Submit"})})]})})]})})},tr=e=>{let{kind:r,email:t,flowType:s,schoolsData:o,cohorts:n}=e,i=(0,ee.useRouter)(),{api:l}=(0,R.Qy)(),{curriculumName:a}=(0,E.JR)();return(0,p.jsx)(y.Z,{pl:{lg:14},py:{xs:4,lg:13},width:{xs:"100%",lg:"368px"},boxSizing:"content-box",children:(0,p.jsx)(X,{email:t,flowType:s,initialValues:{finalExamPeriods:null,school:null,kind:r},onSubmit:e=>{var r,t;let{finalExamPeriods:s,school:o}=e;return l.users.updateUser("me",{final_exam_period:null!=s?s:null,school:null!==(r=null==o?void 0:o.school)&&void 0!==r?r:null,ib_school_code:null!==(t=null==o?void 0:o.ibCode)&&void 0!==t?t:null}).then(()=>{i.push("IGCSE"===a?"/":"/dashboard")})},cohorts:n,schoolsData:o})})},tt=m.z.object({type:m.z.literal("new"),email:m.z.string().email(),code:m.z.string().min(1)}),ts=e=>{let{subjects:r,subjectGroups:t,schoolsData:s,cohorts:o}=e,{notFound:n}=(0,rO.bJ)(),i=(0,f.Z)(),[l,c]=(0,h.useState)(null),[d,x]=(0,h.useState)(u.PasswordAndSecurityForm),[m,g]=(0,h.useState)(null);return(0,h.useEffect)(()=>{let e=new URLSearchParams(location.search);try{let r=tt.parse({type:e.get("type"),email:e.get("email"),code:rU(e.get("code"))});c(r)}catch(e){F.kg.error("Failed to decode setPassword URL params",{error:e}),n()}},[n]),l?(0,p.jsx)(er.Z,{sx:{bgcolor:i.colors.ui.bg_light,minHeight:"calc(100vh - 414px)",display:"flex",flexDirection:"column",overflow:"hidden"},children:(0,p.jsxs)(et.Z,{maxWidth:"xl",sx:{flexGrow:1,display:"flex",flexDirection:{xs:"column",lg:"row"}},children:[(0,p.jsxs)(y.Z,{flexBasis:{lg:"34%"},alignItems:{xs:"center",lg:"flex-start"},position:"relative",children:[(0,p.jsx)(er.Z,{sx:{position:"absolute",right:{xs:"-10vw",lg:0},top:0,height:"100%",width:{xs:"110vw",lg:"50vw"},bgcolor:i.colors.common.brand[100]}}),(0,p.jsx)(rW,{activeProfileMenuItem:d,setActiveProfileMenuItem:x})]}),(0,p.jsxs)(y.Z,{flexBasis:{lg:"66%"},children:[d===u.PasswordAndSecurityForm&&(0,p.jsx)(te,{...l,onSucc:e=>{x(u.Subjects),g(e)}}),d===u.Subjects&&!!m&&(0,p.jsx)(r1,{...l,flowType:a.OnBoarding,kind:m,subjects:r,subjectGroups:t,onSucc:()=>{x(u.AcademicInfo)}}),d===u.AcademicInfo&&!!m&&(0,p.jsx)(tr,{kind:m,email:l.email,flowType:a.OnBoarding,schoolsData:s,cohorts:o})]})]})}):null};var to=t(13888),tn=t.n(to);let ti=e=>{let{subjectGroups:r,subjectGroupSubscriptionAccess:t={},initialSubjectGroupIds:s,onChange:o}=e,n=(0,f.Z)(),{curriculumName:i}=(0,E.JR)(),[l,a]=(0,h.useState)(()=>null!=s?s:[]),c=r.map(e=>{let r=(0,U._A)(e.name);return{label:"".concat("IGCSE"===i?e.superGroupName:i," ").concat(e.name),icon:r&&(0,p.jsx)(r,{}),id:e.id,isPro:!!t[e.id]}}),d=(e,r)=>{let t=[...l];r?t.push(e):z()(t,r=>r===e),a(t),null==o||o(t)};return(0,p.jsx)(y.Z,{width:{lg:"560px",xs:"100%"},sx:{minWidth:"344px"},flexDirection:"row",flexWrap:"wrap",children:(0,p.jsx)(M.Z,{sx:{width:"100%",display:"flex",flexDirection:"row",gap:2,color:n.colors.textIcon.primary,label:{width:{xs:"164px",md:"176px"},display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"flex-start",p:2,margin:0,borderRadius:2,backgroundColor:n.colors.ui.bg_panel},"label:hover":{borderColor:n.colors.button.primary}},children:c.map(e=>{var r;let t=e.isPro||l.includes(e.id);return(0,p.jsx)(L.Z,{label:(0,p.jsxs)(y.Z,{spacing:1,children:[(0,h.cloneElement)(null!==(r=e.icon)&&void 0!==r?r:(0,p.jsx)(_.F8,{}),{sx:{width:"32px",height:"32px"}}),(0,p.jsx)(Z.Z,{variant:"p-sm-semibold",children:e.label})]}),labelPlacement:"start",control:(0,p.jsx)(I.Z,{value:e.id,disabled:e.isPro,size:"small",icon:(0,p.jsx)(_.IE,{}),checkedIcon:(0,p.jsx)(_.Fw,{}),onChange:(r,t)=>d(e.id,t),sx:{mt:-2,mr:-2,svg:{fontSize:"1rem"},":hover":{bgcolor:"transparent"}},checked:t}),sx:{border:"1px solid",borderColor:t?n.colors.button.primary:"transparent"}},e.label)})})})},tl=e=>e.kind===T.VF.Teacher?(0,p.jsx)(tu,{...tn()(e,["subjectGroups","onNext","onSubmit"])}):(0,p.jsx)(ta,{...tn()(e,["subjects","onNext","onSubmit"])}),ta=e=>{let{subjects:r,onNext:t,onSubmit:s}=e,o=(0,f.Z)(),{curriculumName:n}=(0,E.JR)(),{setValue:i}=(0,j.Gc)(),l=(0,h.useCallback)(async e=>{i("subjectIds",e),t()},[i,t]);return(0,p.jsxs)(y.Z,{alignItems:"center",children:[(0,p.jsxs)(y.Z,{spacing:2,pb:7,alignItems:"center",children:[(0,p.jsx)(Z.Z,{variant:"h2-bold",color:o.colors.textIcon.primary,textAlign:"center",children:"Choose Your Subjects"}),(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:o.colors.textIcon.placeholder,textAlign:"center",children:"What courses are you studying?"})]}),"IGCSE"===n?(0,p.jsx)(td,{onNext:l,onSubmit:s}):(0,p.jsx)(tc,{subjects:r,onNext:l,onSubmit:s})]})},tc=e=>{let{subjects:r,onNext:t,onSubmit:s}=e,{watch:o}=(0,j.Gc)(),n=o("subjectIds"),i=rR({flowType:a.Regular,subjects:r,initialSubjects:null!=n?n:[],onSubmit:t});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(rC,{...i}),(0,p.jsx)(tx,{kind:T.VF.Student,onNext:i.submit,onSubmit:s,disabled:0===Object.values(i.selectedSubjects).flatMap(e=>e.all).length})]})},td=e=>{let{onNext:r,onSubmit:t}=e,s=rQ({onSubmit:r});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r$,{value:s}),(0,p.jsx)(tx,{kind:T.VF.Student,onNext:s.submit,onSubmit:t,disabled:0===s.selectedSubjectIds.length})]})},tu=e=>{let{subjectGroups:r,onNext:t,onSubmit:s}=e,o=(0,f.Z)(),{watch:n,setValue:i}=(0,j.Gc)(),l=n("subjectGroupIds");return(0,p.jsxs)(y.Z,{alignItems:"center",children:[(0,p.jsxs)(y.Z,{spacing:2,pb:7,alignItems:"center",children:[(0,p.jsx)(Z.Z,{variant:"h2-bold",color:o.colors.textIcon.primary,textAlign:"center",children:"Choose Your Subjects"}),(0,p.jsx)(Z.Z,{variant:"p-sm-rg",color:o.colors.textIcon.placeholder,textAlign:"center",children:"Which subject(s) do you teach?"})]}),(0,p.jsx)(ti,{subjectGroups:r,initialSubjectGroupIds:l,onChange:e=>i("subjectGroupIds",e)}),(0,p.jsx)(tx,{kind:T.VF.Student,onNext:t,onSubmit:s,disabled:(null==l?void 0:l.length)===0})]})},tx=e=>{let{disabled:r,onNext:t,onSubmit:s}=e,o=(0,f.Z)(),{formState:n,getValues:i,handleSubmit:l}=(0,j.Gc)();return(0,p.jsxs)(y.Z,{spacing:2,alignItems:"center",pt:4,children:[(0,p.jsx)(w.Z,{variant:"solid",color:"primary",size:"large",sx:{px:6},onClick:t,disabled:r||n.isSubmitting,children:"Next"}),(0,p.jsx)(y.Z,{direction:"row",spacing:2,children:(0,p.jsxs)(Z.Z,{variant:"p-md-rg",color:o.colors.textIcon.placeholder,children:["or"," ",(0,p.jsx)(G.Z,{component:"button",variant:"p-md-semibold",color:n.isSubmitting?o.colors.textIcon.disabled:o.colors.textIcon.primary,disabled:n.isSubmitting,sx:{textDecoration:"none",cursor:"pointer",...!n.isSubmitting&&{"&:hover":{textDecoration:n.isSubmitting?"none":"underline"}}},onClick:l(s,()=>s(i())),children:"Skip"})]})})]})},tp=e=>{let{kind:r,schoolsData:t,cohorts:s,onSubmit:o}=e,n=(0,f.Z)(),{formState:i,handleSubmit:l,getValues:a}=(0,j.Gc)();return(0,p.jsxs)(y.Z,{width:"100%",maxWidth:"24rem",children:[(0,p.jsx)(Z.Z,{variant:"h2-bold",color:n.colors.textIcon.primary,pb:7,textAlign:"center",children:"Academic Info"}),(0,p.jsx)($,{kind:r,schoolsData:t,cohorts:s}),(0,p.jsxs)(y.Z,{spacing:2,mb:3,alignItems:"center",pt:4,children:[(0,p.jsx)(w.Z,{variant:"solid",color:"cta",size:"large",sx:{px:6},type:"submit",disabled:i.isSubmitting,children:(0,p.jsx)(A.aN,{isLoading:i.isSubmitting,size:24,sx:{margin:"auto",mt:.5,color:n.colors.textIcon.inverse},children:"Finish"})}),(0,p.jsx)(y.Z,{direction:"row",spacing:2,children:(0,p.jsxs)(Z.Z,{variant:"p-md-rg",color:n.colors.textIcon.placeholder,children:["or"," ",(0,p.jsx)(G.Z,{component:"button",variant:"p-md-semibold",color:i.isSubmitting?n.colors.textIcon.disabled:n.colors.textIcon.standout,disabled:i.isSubmitting,sx:{textDecoration:"none",cursor:"pointer",...!i.isSubmitting&&{"&:hover":{textDecoration:i.isSubmitting?"none":"underline"}}},onClick:l(o,()=>o(a())),children:"Skip and Finish"})]})})]})]})};(i=x||(x={})).UserType="UserType",i.SubjectSelect="SubjectSelect",i.AcademicInfo="AcademicInfo";let th=m.z.object({kind:m.z.nativeEnum(T.VF).nullable(),subjectIds:m.z.array(m.z.string()).optional(),subjectGroupIds:m.z.array(m.z.string()).optional()}).and(J),tm=e=>{let{subjects:r,subjectGroups:t,schoolsData:s,cohorts:o}=e,n=(0,f.Z)(),i=(0,ee.useRouter)(),{api:l}=(0,R.Qy)(),{curriculumName:a}=(0,E.JR)(),[c,d]=(0,h.useState)("UserType"),u=(0,j.cI)({resolver:(0,v.F)(th),defaultValues:{kind:null,subjectIds:void 0,subjectGroupIds:void 0,finalExamPeriods:null,school:null}}),x=u.watch("kind"),m=()=>{"UserType"===c?d("SubjectSelect"):"SubjectSelect"===c&&d("AcademicInfo"),window.scrollTo(0,0)},g=async e=>{let{kind:r,finalExamPeriods:t,school:s,subjectIds:o,subjectGroupIds:n}=e;try{await l.users.updateUser("me",{has_onboarded:!0,kind:null!=r?r:T.VF.Student,final_exam_period:null!=t?t:void 0,school:null==s?void 0:s.school,ib_school_code:null==s?void 0:s.ibCode,ib_school_country:null==s?void 0:s.country,ib_school_region:null==s?void 0:s.region,subjects:o,subjectGroups:n}),"IB"===a&&x===T.VF.Student?await i.push("/dashboard"):await i.push("/")}catch(e){P.A9.error("An error occurred while saving. Please try again.",{autoHideDuration:2e3})}};return(0,p.jsx)(j.RV,{...u,children:(0,p.jsxs)("form",{onSubmit:u.handleSubmit(g),children:[(0,p.jsx)(y.Z,{divider:(0,p.jsx)(ry.Z,{orientation:"horizontal",flexItem:!0}),children:(0,p.jsx)(et.Z,{maxWidth:"xl",children:(0,p.jsxs)(y.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",py:2,sx:{borderBottom:"1px solid ".concat(n.colors.ui.border)},children:[(0,p.jsx)(w.Z,{variant:"outline",color:"secondary",size:"small",startIcon:(0,p.jsx)(_.BN,{}),onClick:()=>{"SubjectSelect"===c?d("UserType"):"AcademicInfo"===c&&d("SubjectSelect"),window.scrollTo(0,0)},sx:{visibility:"UserType"!==c?"visible":"hidden"},children:"Back"}),(0,p.jsx)(Z.Z,{variant:"p-xs-rg",color:n.colors.textIcon.placeholder,children:"Setup your account"})]})})}),(0,p.jsx)(et.Z,{maxWidth:"xl",children:(0,p.jsxs)(y.Z,{py:7,alignItems:"center",children:["UserType"===c&&(0,p.jsxs)(y.Z,{spacing:7,alignItems:"center",width:"100%",maxWidth:"24rem",children:[(0,p.jsx)(Z.Z,{variant:"h2-bold",textAlign:"center",children:"Select User Type"}),(0,p.jsx)(eT.FU,{value:x,onChange:e=>{u.reset(),u.setValue("kind",e)}}),(0,p.jsx)(w.Z,{variant:"solid",color:"primary",size:"large",disabled:!x,onClick:m,sx:{px:10},children:"Next"})]}),"SubjectSelect"===c&&!!x&&(0,p.jsx)(tl,{kind:x,subjects:r,subjectGroups:t,onNext:m,onSubmit:g}),"AcademicInfo"===c&&!!x&&(0,p.jsx)(tp,{kind:x,schoolsData:s,cohorts:o,onSubmit:g})]})})]})})};t(35917)},66357:function(e,r,t){t.d(r,{V:function(){return m}});var s=t(52322),o=t(36234),n=t(39097),i=t.n(n),l=t(2784),a=t(51379),c=t(84311),d=t(78502),u=t(81836),x=t(52519),p=t(76385),h=t(71946);let m=e=>{let{children:r,userFreeTrialStatWithCode:t}=e,n=(0,d.Z)(),[m,g]=(0,l.useState)(function(e){if(!e||!e.isEligible||!e.offerSentOutDate)return!1;let{offerSentOutDate:r,offerDays:t,offerRedeemedDate:s}=e;return!s&&o.ou.fromISO(r).plus({day:t})>o.ou.now()}(t));return(0,s.jsxs)(s.Fragment,{children:[m&&(0,s.jsx)(u.Z,{sx:{flexDirection:"row",minHeight:{xs:(0,a.Q1)(230),md:(0,a.Q1)(80)},background:n.colors.textIcon.primary,justifyContent:"center",alignItems:"center",width:"100vw"},children:(0,s.jsxs)(x.Z,{maxWidth:"xl",sx:{display:"flex",height:"100%",flexFlow:{xs:"column nowrap",md:"row nowrap"},justifyContent:"space-between",alignItems:"center",gap:{xs:2,md:0}},children:[(0,s.jsx)(p.Z,{variant:"h5-bold",color:n.colors.ui.border,sx:{textAlign:{xs:"center",md:"left"}},children:"Try another course for free - no purchase required!"}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(c.a7,{countDownProps:{date:o.ou.fromISO(t.offerSentOutDate).plus({day:t.offerDays}).toISO(),onComplete:()=>{g(!1)}},numberTypographyProps:{fontSize:(0,a.Q1)(24),fontWeight:700,lineHeight:28/24}})}),(0,s.jsx)(h.Z,{variant:"solid",color:"cta",sx:{textAlign:"center",width:{xs:(0,a.Q1)(295),md:(0,a.Q1)(176)}},LinkComponent:i(),href:"/free-trial",children:"Try it now"})]})}),r]})}}}]);